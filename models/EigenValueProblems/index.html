



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Eigenvalue problems - FreeFem++</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#references" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="FreeFem++" class="md-header-nav__button md-logo">
          
            <img src="../../images/favicon.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                FreeFem++
              </span>
              <span class="md-header-nav__topic">
                Eigenvalue problems
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/FreeFem/FreeFem-doc/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      FreeFem++ on Github
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Introduction" class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../documentation/" title="Documentation" class="md-tabs__link">
          Documentation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../reference/" title="Language References" class="md-tabs__link">
          Language References
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/" title="Tutorials" class="md-tabs__link">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../examples/" title="Examples" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Models" class="md-tabs__link md-tabs__link--active">
          Models
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="FreeFem++" class="md-nav__button md-logo">
      
        <img src="../../images/favicon.png" width="48" height="48">
      
    </a>
    FreeFem++
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/FreeFem/FreeFem-doc/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      FreeFem++ on Github
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/contributing/" title="How to contribute?" class="md-nav__link">
      How to contribute?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/citation/" title="Citation" class="md-nav__link">
      Citation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/authors/" title="Authors" class="md-nav__link">
      Authors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Notations/" title="Some Notations" class="md-nav__link">
      Some Notations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/MeshGeneration/" title="Mesh Generation" class="md-nav__link">
      Mesh Generation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/FiniteElement/" title="Finite Element" class="md-nav__link">
      Finite Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/AlgorithmsOptimization/" title="Algorithms & Optimization" class="md-nav__link">
      Algorithms & Optimization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Parallelization/" title="Parallelization" class="md-nav__link">
      Parallelization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Developers/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Language References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Language References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Types/" title="Types" class="md-nav__link">
      Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/GlobalVariables/" title="Global variables" class="md-nav__link">
      Global variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/QuadratureFormulae/" title="Quadrature formulae" class="md-nav__link">
      Quadrature formulae
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Operators/" title="Operators" class="md-nav__link">
      Operators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Loops/" title="Loops" class="md-nav__link">
      Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/IO/" title="I/O" class="md-nav__link">
      I/O
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/ExternalLibraries/" title="External libraries" class="md-nav__link">
      External libraries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Poisson/" title="Poisson's equation" class="md-nav__link">
      Poisson's equation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/EquationsClassification/" title="Classification of the equations" class="md-nav__link">
      Classification of the equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Membrane/" title="Membrane" class="md-nav__link">
      Membrane
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/HeatExchanger/" title="Heat Exchanger" class="md-nav__link">
      Heat Exchanger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Acoustics/" title="Acoustics" class="md-nav__link">
      Acoustics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ThermalConduction/" title="Thermal Conduction" class="md-nav__link">
      Thermal Conduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/FanBlade/" title="Irrotational Fan Blade Flow and Thermal effects" class="md-nav__link">
      Irrotational Fan Blade Flow and Thermal effects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/RotatingHill/" title="Pure convection, The rotating hill" class="md-nav__link">
      Pure convection, The rotating hill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Elasticity/" title="The system of elasticity" class="md-nav__link">
      The system of elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Stokes/" title="The system of Stokes for fluids" class="md-nav__link">
      The system of Stokes for fluids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/NavierStokesProjection/" title="A projection Algorithm for the Navier-Stokes equations" class="md-nav__link">
      A projection Algorithm for the Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/NavierStokesNewton/" title="Newton method for the steady Navier-Stokes equations" class="md-nav__link">
      Newton method for the steady Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ALargeFluidProblem/" title="A large fluid problem" class="md-nav__link">
      A large fluid problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ComplexNumbers/" title="An example with complex numbers" class="md-nav__link">
      An example with complex numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/OptimalControl/" title="Optimal control" class="md-nav__link">
      Optimal control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/FlowWithShocks/" title="A flow with shocks" class="md-nav__link">
      A flow with shocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/HeatEquationOptimization/" title="Time dependent schema optimization for heat equations" class="md-nav__link">
      Time dependent schema optimization for heat equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/TimeDependentStokes/" title="A transient Stokes solver in matrix form" class="md-nav__link">
      A transient Stokes solver in matrix form
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/WifiPropagation/" title="Wifi Propagation" class="md-nav__link">
      Wifi Propagation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/MatlabOctavePlot/" title="Matlab / Octave Plots" class="md-nav__link">
      Matlab / Octave Plots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../StaticProblems/" title="Static problems" class="md-nav__link">
      Static problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Elasticity/" title="Elasticity" class="md-nav__link">
      Elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NonLinearStaticProblems/" title="Non-linear static problems" class="md-nav__link">
      Non-linear static problems
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Eigenvalue problems
      </label>
    
    <a href="./" title="Eigenvalue problems" class="md-nav__link md-nav__link--active">
      Eigenvalue problems
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EvolutionProblems/" title="Evolution problems" class="md-nav__link">
      Evolution problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NavierStokesEquations/" title="Navier-Stokes equations" class="md-nav__link">
      Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../VariationalInequality/" title="Variational inequality" class="md-nav__link">
      Variational inequality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DomainDecomposition/" title="Domain decomposition" class="md-nav__link">
      Domain decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FluidStructureCoupledProblem/" title="Fluid-Structure coupled problem" class="md-nav__link">
      Fluid-Structure coupled problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TransmissionProblem/" title="Transmission problem" class="md-nav__link">
      Transmission problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FreeBoundaryProblem/" title="Free boundary problem" class="md-nav__link">
      Free boundary problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NonLinearElasticity/" title="Non-linear elasticity" class="md-nav__link">
      Non-linear elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CompressibleNeoHookeanMaterials/" title="Compressible Neo-Hookean materials" class="md-nav__link">
      Compressible Neo-Hookean materials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../WhisperingGalleryModes/" title="Whispering gallery modes" class="md-nav__link">
      Whispering gallery modes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/FreeFem/FreeFem-doc/edit/master/docs/models/EigenValueProblems.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Eigenvalue problems</h1>
                
                <p>This section depends on your installation of FreeFem++; you need to have compiled <code>ARPACK</code>. This tool is available in FreeFem++ if the word eigenvalue appears in line Load:, like:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>-- FreeFem++ v*.** <span class="o">(</span>date *** *** ** **:**:** CET ****<span class="o">)</span>
 file : ***.edp
 Load: lg_fem lg_mesh eigenvalue
</pre></div>
</td></tr></table>

<p>This tool is based on <a href="http://www.caam.rice.edu/software/ARPACK/"><code>arpack++</code></a>, the object-oriented version of <code>ARPACK</code> eigenvalue package <a href="#LEHOUCQ1998">LEHOUCQ1998</a>.</p>
<p>The function <code class="codehilite"><span class="nf">EigenValue</span></code> computes the generalized eigenvalue of <span><span class="MathJax_Preview">A u = \lambda B u</span><script type="math/tex">A u = \lambda B u</script></span>. The Shift-invert method is used by default, with sigma =<span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> the shift of the method.</p>
<p>The matrix <span><span class="MathJax_Preview">OP</span><script type="math/tex">OP</script></span> is defined with <span><span class="MathJax_Preview">A - \sigma B</span><script type="math/tex">A - \sigma B</script></span>.</p>
<p>The return value is the number of converged eigenvalues (can be greater than the number of requested eigenvalues nev=)</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="n">OP</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="kp">nev</span><span class="o">=</span><span class="n">Nev</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="n">Sigma</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>where the matrix $OP= A - \sigma B $ with a solver and boundary condition, and the matrix <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span>.</p>
<p>There is also a functional interface:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="n">FOP1</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="kp">nev</span><span class="o">=</span><span class="n">Nev</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="n">Sigma</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>where <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> is the size of the problem, and the operators are now defined through functions, defining respectively the matrix product of <span><span class="MathJax_Preview">OP^{-1}</span><script type="math/tex">OP^{-1}</script></span> and <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span>, as in</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="n">OP1</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">FOP1</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">u</span><span class="p">){</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Au</span> <span class="o">=</span> <span class="n">OP</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="p">;</span> <span class="k">return</span> <span class="n">Au</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">FB</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">u</span><span class="p">){</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Au</span> <span class="o">=</span> <span class="kp">B</span><span class="o">*</span><span class="n">u</span><span class="p">;</span> <span class="k">return</span> <span class="n">Au</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>If you want finer control over the method employed in <code>ARPACK</code>, you can specify which mode <code>ARPACK</code> will work with (<code class="codehilite"><span class="kp">mode</span><span class="o">=</span></code> , see <a href="#LEHOUCQ1998">ARPACK documentation</a>). The operators necessary for the chosen mode can be passed through the optional parameters <code class="codehilite"><span class="kp">A</span><span class="o">=</span></code>, <code class="codehilite"><span class="kp">A1</span><span class="o">=</span></code>, <code class="codehilite"><span class="kp">B</span><span class="o">=</span></code>, <code class="codehilite"><span class="kp">B1</span><span class="o">=</span></code>, (see below).</p>
<ul>
<li>
<p><code class="codehilite"><span class="kp">mode</span><span class="o">=</span><span class="mi">1</span></code>: Regular mode for solving <span><span class="MathJax_Preview">A u = \lambda u</span><script type="math/tex">A u = \lambda u</script></span></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">FOP</span><span class="p">,</span> <span class="kp">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nev</span><span class="o">=</span><span class="n">Nev</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>where the function FOP defines the matrix product of A</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">mode</span><span class="o">=</span><span class="mi">2</span></code>: Regular inverse mode for solving <span><span class="MathJax_Preview">A u = \lambda B u</span><script type="math/tex">A u = \lambda B u</script></span></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">FOP</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span> <span class="kp">B1</span><span class="o">=</span><span class="n">FB1</span><span class="p">,</span> <span class="kp">mode</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="kp">nev</span><span class="o">=</span><span class="n">Nev</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>where the functions FOP, FB and FB1 define respectively the matrix product of <span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>, <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span> and <span><span class="MathJax_Preview">B^{-1}</span><script type="math/tex">B^{-1}</script></span></p>
</li>
<li>
<p><code class="codehilite"><span class="kp">mode</span><span class="o">=</span><span class="mi">3</span></code>: Shift-invert mode for solving <span><span class="MathJax_Preview">A u = \lambda B u</span><script type="math/tex">A u = \lambda B u</script></span></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kp">A1</span><span class="o">=</span><span class="n">FOP1</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span> <span class="kp">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="n">Sigma</span><span class="p">,</span> <span class="kp">nev</span><span class="o">=</span><span class="n">Nev</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>where the functions FOP1 and FB define respectively the matrix product of <span><span class="MathJax_Preview">OP^{-1} = (A - \sigma B)^{-1}</span><script type="math/tex">OP^{-1} = (A - \sigma B)^{-1}</script></span> and <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span></p>
</li>
</ul>
<p>You can also specify which subset of eigenvalues you want to compute (<code class="codehilite"><span class="kp">which</span><span class="o">=</span></code>). The default value is <code class="codehilite"><span class="kp">which</span><span class="o">=</span><span class="s">&quot;LM&quot;</span></code>, for eigenvalues with largest magnitude. <code class="codehilite"><span class="s">&quot;SM&quot;</span></code> is for smallest magnitude, <code class="codehilite"><span class="s">&quot;LA&quot;</span></code> for largest algebraic value, <code class="codehilite"><span class="s">&quot;SA&quot;</span></code> for smallest algebraic value, and <code class="codehilite"><span class="s">&quot;BE&quot;</span></code> for both ends of the spectrum.</p>
<p>Remark: For complex problems, you need to use the keyword <code class="codehilite"><span class="nf">complexEigenValue</span></code> instead of <code class="codehilite"><span class="nf">EigenValue</span></code> when passing operators through functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Boundary condition and Eigenvalue Problems</p>
<p>The locking (Dirichlet) boundary condition is make with exact penalization so we put <code class="codehilite"><span class="mf">1e30</span><span class="o">=</span><span class="kp">tgv</span></code> on the diagonal term of the locked degree of freedom (see <a href="/documentation/FiniteElement/#variational-form-sparse-matrix-pde-data-vector">Finite Element chapter</a>). So take Dirichlet boundary condition just on <span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span> and not on <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span> because we solve <span><span class="MathJax_Preview">w=OP^{-1}*B*v</span><script type="math/tex">w=OP^{-1}*B*v</script></span>.</p>
<!--- ** --->

<p>If you put locking (Dirichlet) boundary condition on <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span> matrix (with key work <code class="codehilite"><span class="nf">on</span></code>) you get small spurious modes <span><span class="MathJax_Preview">(10^{-30})</span><script type="math/tex">(10^{-30})</script></span>, due to boundary condition, but if you forget the locking boundary condition on <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span> matrix (no keywork <code class="codehilite"><span class="nf">on</span></code>) you get huge spurious <span><span class="MathJax_Preview">(10^{30})</span><script type="math/tex">(10^{30})</script></span> modes associated to these boundary conditons. We compute only small mode, so we get the good one in this case.</p>
</div>
<ul>
<li>
<p><code class="codehilite"><span class="kp">sym</span><span class="o">=</span></code>
    The problem is symmetric (all the eigen value are real)</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">nev</span><span class="o">=</span></code>
    The number desired eigenvalues (nev) close to the shift.</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">value</span><span class="o">=</span></code>
    The array to store the real part of the eigenvalues</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">ivalue</span><span class="o">=</span></code>
    The array to store the imag. part of the eigenvalues</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">vector</span><span class="o">=</span></code>
    The FE function array to store the eigenvectors</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">rawvector</span><span class="o">=</span></code>
    An array of type <code class="codehilite"><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code> to store eigenvectors by column.</p>
<p>For real non symmetric problems, complex eigenvectors are given as two consecutive vectors, so if eigenvalue <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> and <span><span class="MathJax_Preview">k+1</span><script type="math/tex">k+1</script></span> are complex conjugate eigenvalues, the <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span>th vector will contain the real part and the <span><span class="MathJax_Preview">k+1</span><script type="math/tex">k+1</script></span>th vector the imaginary part of the corresponding complex conjugate eigenvectors.</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">tol</span><span class="o">=</span></code>
    The relative accuracy to which eigenvalues are to be determined;</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">sigma</span><span class="o">=</span></code>
    The shift value;</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">maxit</span><span class="o">=</span></code>
    The maximum number of iterations allowed;</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">ncv</span><span class="o">=</span></code>
    The number of Arnoldi vectors generated at each iteration of <code>ARPACK</code>;</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">mode</span><span class="o">=</span></code>
    The computational mode used by <code>ARPACK</code> (see above);</p>
</li>
<li>
<p><code class="codehilite"><span class="kp">which</span><span class="o">=</span></code>
The requested subset of eigenvalues (see above).</p>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Laplace eigenvalue</p>
<p>In the first example, we compute the eigenvalues and the eigenvectors of the Dirichlet problem on square <span><span class="MathJax_Preview">\Omega=]0,\pi[^2</span><script type="math/tex">\Omega=]0,\pi[^2</script></span>.</p>
<p>The problem is to find: <span><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>, and <span><span class="MathJax_Preview">\nabla u_{\lambda}</span><script type="math/tex">\nabla u_{\lambda}</script></span> in <span><span class="MathJax_Preview">\mathbb{R}{\times} H^1_0(\Omega)</span><script type="math/tex">\mathbb{R}{\times} H^1_0(\Omega)</script></span>
<script type="math/tex; mode=display">
\int_\Omega \nabla u_{\lambda} \nabla v = \lambda \int_\Omega u v \quad \forall v \in H^1_0(\Omega)
</script>
</p>
<p>The exact eigenvalues are <span><span class="MathJax_Preview">\lambda_{n,m} =(n^2+m^2), (n,m)\in {\mathbb{N}_*}^2</span><script type="math/tex">\lambda_{n,m} =(n^2+m^2), (n,m)\in {\mathbb{N}_*}^2</script></span> with the associated eigenvectors are <span><span class="MathJax_Preview">u_{{m,n}}=sin(nx)*sin(my)</span><script type="math/tex">u_{{m,n}}=sin(nx)*sin(my)</script></span>.</p>
<!--- ** --->

<p>We use the generalized inverse shift mode of the <code>arpack++</code> library, to find 20 eigenvalues and eigenvectors close to the shift value <span><span class="MathJax_Preview">\sigma=20</span><script type="math/tex">\sigma=20</script></span>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// Parameters</span>
<span class="kr">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">real</span> <span class="kp">sigma</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">//value of the shift</span>
<span class="kt">int</span> <span class="kp">nev</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">//number of computed eigen value close to sigma</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="kr">pi</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="c1">// OP = A - sigma B ; // the shifted matrix</span>
<span class="kt">varf</span> <span class="kp">op</span> <span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
        <span class="o">-</span> <span class="kp">sigma</span><span class="o">*</span> <span class="n">u1</span><span class="o">*</span><span class="n">u2</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">u1</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="kt">varf</span> <span class="nf">b</span> <span class="p">([</span><span class="n">u1</span><span class="p">],</span> <span class="p">[</span><span class="n">u2</span><span class="p">])</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">u1</span><span class="o">*</span><span class="n">u2</span><span class="p">);</span> <span class="c1">//no boundary condition</span>

<span class="kt">matrix</span> <span class="n">OP</span> <span class="o">=</span> <span class="kp">op</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">Crout</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//crout solver because the matrix in not positive</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span> <span class="kp">eps</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">);</span>

<span class="c1">// important remark:</span>
<span class="c1">// the boundary condition is make with exact penalization:</span>
<span class="c1">// we put 1e30=tgv on the diagonal term of the lock degree of freedom.</span>
<span class="c1">// So take Dirichlet boundary condition just on $a$ variational form</span>
<span class="c1">// and not on $b$ variational form.</span>
<span class="c1">// because we solve $ w=OP^-1*B*v $</span>

<span class="c1">// Solve</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ev</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvalue</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">eV</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvector</span>

<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="n">OP</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="kp">sym</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="kp">sigma</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="kp">vector</span><span class="o">=</span><span class="n">eV</span><span class="p">,</span>
    <span class="kp">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kp">maxit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">ncv</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Display &amp; Plot</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">eV</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kt">real</span> <span class="n">gg</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">));</span>
    <span class="kt">real</span> <span class="n">mm</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">u1</span><span class="o">*</span><span class="n">u1</span><span class="p">)</span> <span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;lambda[&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, err= &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">u1</span><span class="o">*</span><span class="n">u1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">eV</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Eigen Vector &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot; value =&quot;</span><span class="o">+</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The output of this example is:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.0002</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">1.46519e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.00074</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">4.05158e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0011</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">2.84925e-12</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0011</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">7.25456e-12</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.002</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">1.74257e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.0039</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">1.22554e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.0046</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">1.06274e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.0048</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">1.03883e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mf">18.0083</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">4.05497e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0096</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">2.21678e-13</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0096</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">4.16212e-14</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mf">25.014</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">7.42931e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mf">25.0283</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">6.77444e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mf">26.0159</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">3.19864e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mf">26.0159</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">4.9652e-12</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">29.0258</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="o">-</span><span class="mf">9.99573e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mf">29.0273</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">1.38242e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mf">32.0449</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">1.2522e-10</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mf">34.049</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">3.40213e-11</span>
<span class="n">lambda</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mf">34.0492</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span> <span class="mf">2.41751e-10</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center"><a name="Fig17">Fig. 17</a>: Isovalue of 11th eigenvector <span><span class="MathJax_Preview">u_{4,3}-u_{3,4}</span><script type="math/tex">u_{4,3}-u_{3,4}</script></span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img alt="EigenValueProblems" src="../images/EigenValueProblems1.png" /></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="center"><a name="Fig18">Fig. 18</a>: Isovalue of 12th eigenvector <span><span class="MathJax_Preview">u_{4,3}+u_{3,4}</span><script type="math/tex">u_{4,3}+u_{3,4}</script></span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img alt="EigenValueProblems2" src="../images/EigenValueProblems2.png" /></td>
</tr>
</tbody>
</table>
</div>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h2>
<p><a name="LEHOUCQ1998">[LEHOUCQ1998]</a> LEHOUCQ, Richard B., SORENSEN, Danny C., et YANG, Chao. ARPACK users' guide: solution of large-scale eigenvalue problems with implicitly restarted Arnoldi methods. Siam, 1998.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../NonLinearStaticProblems/" title="Non-linear static problems" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Non-linear static problems
              </span>
            </div>
          </a>
        
        
          <a href="../EvolutionProblems/" title="Evolution problems" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Evolution problems
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/FreeFem/FreeFem-doc" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AMS_CHTML"></script>
      
        <script src="../../mathjax-config.js"></script>
      
    
    
      
    
  </body>
</html>
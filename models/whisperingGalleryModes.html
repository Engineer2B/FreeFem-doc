<!DOCTYPE html>

<html lang="en">
	<head>
		  <meta charset="UTF-8">
  <title>Whispering gallery modes</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- MathJax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <script src="../_static/js/mathjax-config.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-sources" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
<script async src="../_static/js/github.js"></script>
		
		<nav id="nav">
	<div style="display: none;">
		<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFEM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#easy-installation">Easy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-binary-installation">Windows binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-binary-installation">MacOS X binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#text-editor">Text-editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compilation">Compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#branches-os-status">Branches / OS status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation/notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#square">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#border">Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#multi-border">Multi-Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#the-keyword-triangulate">The keyword “triangulate”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#boundary-fem-spaces-built-as-empty-meshes">Boundary FEM Spaces Built as Empty Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#remeshing">Remeshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#movemesh">Movemesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#regular-triangulation-htriangle">Regular Triangulation: hTriangle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#adaptmesh">Adaptmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#trunc">Trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#splitmesh">Splitmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#meshing-examples">Meshing Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">How to change the label of elements and border elements of a mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mesh-in-three-dimensions">Mesh in three dimensions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#layer-mesh">Layer mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#meshing-examples-1">Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#medit">Medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mshmet">Mshmet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#freeyams">FreeYams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mmg3d">mmg3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#build-a-2d-mesh-from-a-isoline">Build a 2d mesh from a isoline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/finiteElement.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#use-of-freefem-fespace-in-2d">Use of freefem fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/algorithmsOptimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#hpddm-solvers">HPDDM solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#time-dependent-problem">Time dependent problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#distributed-vectors-in-hpddm">Distributed vectors in HPDDM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/introddm.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../documentation/ffddm/introddm.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="../documentation/ffddm/introddm.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../example/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/finiteElement.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/algoOptimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr/lunr_index.js"></script>

<div class="search-container">
	<label for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Search ..." id="searchInput">
	<div id="searchResults"></div>
</div>

<script src="../_static/js/search.js"></script>
<script>
   initSearch('../')
</script>
	
</nav>
<script async src="../_static/js/nav.js"></script>
		

		<div id="subnav">
	<div style="display: none">
		<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
</ul>

	</div>
</div>
<script async src="../_static/js/subnav.js"></script>
		
		<div id="content">
			
   <div class="section" id="whispering-gallery-modes">
<h1>Whispering gallery modes<a class="headerlink" href="#whispering-gallery-modes" title="Permalink to this headline"> </a></h1>
<p>Author: <a class="reference external" href="http://linkeding.com/in/grudinin">I. S. Grudinin</a></p>
<p>In whispering gallery mode (WGM) resonators, which are typically spheres or disks, electromagnetic field is trapped by total internal reflections from the boundary.
Modes of such resonators are distinguished by compact volume and record high quality factors (Q) in a broad range of frequencies.</p>
<p>Modern applications of such resonators include microwave and optical cavities for atomic clocks, cavity optomechanics, nonlinear and quantum optics.
Analytical solutions for WG modes are only available for a limited number of idealized geometries, such as sphere or ellipsoid.
Since resonator dimensions are typically much larger than optical wavelength, direct application of numerical 3D finite difference time domain (FDTD) or finite element methods (FEM) is not practical.
It’s possible to solve the vectorial wave equation by reducing it to a two dimensional case by taking axial symmetry into account.</p>
<p>Such reduction leads to a system of 3 equations to be solved in a 2D “<span class="math notranslate nohighlight">\(\rho-z\)</span>” section of a resonator.
Please refer to <a class="reference internal" href="../references.html#oxborrow2007" id="id1">[OXBORROW2007]</a> for a detailed derivation and to <a class="reference internal" href="../references.html#grudinin2012" id="id2">[GRUDININ2012]</a> for an example of using <strong>FreeFEM</strong> to compute WGMs.</p>
<div class="section" id="wave-equation-for-the-wgms">
<h2>Wave equation for the WGMs<a class="headerlink" href="#wave-equation-for-the-wgms" title="Permalink to this headline"> </a></h2>
<p>Since electric field is discontinuous on the surface of a dielectric and magnetic field is typically not, we derive our equations for the magnetic field.
The electric field can be easily derived at a later stage from <span class="math notranslate nohighlight">\(\vec{E}=\frac{i}{\omega\epsilon_0}\hat{\epsilon}^{-1}\nabla\times\vec{H}\)</span>.
Following a standard procedure starting with Maxwell equations we derive a wave equation in a single-axis anisotropic medium such as an optical crystal:</p>
<div class="math notranslate nohighlight" id="equation-eqn-wave">
<span class="eqno">()<a class="headerlink" href="#equation-eqn-wave" title="Permalink to this equation"> </a></span>\[\nabla\times\left(\hat{\epsilon}^{-1}\nabla\times\vec{H}\right)-k_0^2\vec{H}-\alpha\nabla\left(\nabla\cdot\vec{H}\right)=0\]</div>
<p>Here <span class="math notranslate nohighlight">\(k_0=\omega/c\)</span> is the wavenumber, <span class="math notranslate nohighlight">\(\alpha\)</span> is the penalty term added to fight spurious FEM solutions.
For anisotropic single-axis medium with <span class="math notranslate nohighlight">\(\partial\hat{\epsilon}/\partial\phi=0\)</span> in cylindrical system of coordinates we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{\epsilon}=\begin{pmatrix} \epsilon_{\rho} &amp; 0 &amp; 0 \\ 0 &amp; \epsilon_{\rho} &amp; 0 \\ 0 &amp; 0 &amp; \epsilon_z \end{pmatrix}. \nonumber\end{split}\]</div>
<p>We now assume axial symmetry of our electromagnetic fields and insert an imaginary unity in front of the <span class="math notranslate nohighlight">\(H_{\phi}\)</span> to allow all field components to be real numbers and also to account for the phase shift of this component <span class="math notranslate nohighlight">\(\vec{H}(\rho,\phi,z)=\left\{H_{\rho}(\rho,z),iH_{\phi}(\rho,z),H_z(\rho,z)\right\}\times e^{im\phi}\)</span>.</p>
<p>We write the wave equation <a class="reference internal" href="#equation-eqn-wave">()</a> explicitly in cylindrical coordinates, thus obtaining a set of three differential equations for the domain <span class="math notranslate nohighlight">\(\Omega\)</span> given by the resonator’s cross section and some space outside:</p>
<div class="math notranslate nohighlight" id="equation-eqn-system">
<span class="eqno">()<a class="headerlink" href="#equation-eqn-system" title="Permalink to this equation"> </a></span>\[\begin{split}\begin{array}{rcl}
    A_1\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0\\ \nonumber
    A_2\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0\\ \nonumber
    A_3\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0
\end{array}\end{split}\]</div>
<p>The numerical solutions of these equations and boundary conditions can be found with <strong>FreeFEM</strong> if we write the system in the weak, or integral form.</p>
</div>
<div class="section" id="weak-formulation">
<h2>Weak formulation<a class="headerlink" href="#weak-formulation" title="Permalink to this headline"> </a></h2>
<p>In general, to obtain the integral or “weak” statements equivalent to system <a class="reference internal" href="#equation-eqn-system">()</a> and boundary conditions we form a scalar dot product between an arbitrary magnetic field test function <span class="math notranslate nohighlight">\(\mathbf{H}^t=\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}\)</span> and the components of our vectorial equation <span class="math notranslate nohighlight">\(A_1,A_2,A_3\)</span>, and integrate over the resonator’s cross section domain <span class="math notranslate nohighlight">\(\Omega\)</span> (and its boundary for the boundary conditions):</p>
<div class="math notranslate nohighlight">
\[\int\limits_{\Omega}(H^t_{\rho}A_1+H^t_{\phi}A_2+H^t_{z}A_3)d\Omega\]</div>
<p>We can reduce the order of partial derivatives in this integral by using the Green’s formula for integration by parts.
For example:</p>
<div class="math notranslate nohighlight">
\[\int\limits_{\Omega}H_z^t \frac{\partial^2 H_z}{\partial \rho^2 }d\Omega=
-\int\limits_{\Omega}\frac{\partial H_z^t}{\partial \rho}\frac{\partial H_z}{\partial \rho }d\Omega+\oint H_z^t\frac{\partial H_z}{\partial \rho}n_{\rho}d\Gamma\]</div>
<p>Thus converting equations <a class="reference internal" href="#equation-eqn-system">()</a> we obtain a large expression for the weak form.</p>
</div>
<div class="section" id="a-dielectric-sphere-example-with-freefem">
<h2>A dielectric sphere example with FreeFEM<a class="headerlink" href="#a-dielectric-sphere-example-with-freefem" title="Permalink to this headline"> </a></h2>
<p>We now compute the fundamental mode frequency for a fused silica sphere.
The sphere is 36 micrometer in diameter, the refractive index is 1.46, the boundary condition is the magnetic wall (which can actually be omitted as it holds automatically).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">radius</span> <span class="o">=</span> <span class="mi">36</span><span class="p">;</span> <span class="c1">//approximate radius of the cavity</span>
<span class="kt">real</span> <span class="n">yb</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">yt</span> <span class="o">=</span> <span class="o">-</span><span class="n">yb</span><span class="p">;</span> <span class="c1">//window yb=bottom and yt=top coordinates</span>
<span class="kt">real</span> <span class="n">xl</span> <span class="o">=</span> <span class="n">radius</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">xr</span> <span class="o">=</span> <span class="n">radius</span><span class="o">+</span><span class="mi">3</span><span class="p">;</span> <span class="c1">//window xl=left and xr=right coordinates</span>
<span class="kt">real</span> <span class="n">angle</span> <span class="o">=</span> <span class="nf">asin</span><span class="p">((</span><span class="n">yt</span><span class="p">)</span><span class="o">/</span><span class="n">radius</span><span class="p">);</span> <span class="c1">//angle of the sphere segment to model in radians</span>
<span class="kt">int</span> <span class="n">Nm</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span> <span class="c1">//number of mesh vertices per border</span>
<span class="kt">real</span> <span class="n">ne</span> <span class="o">=</span> <span class="mf">1.46</span><span class="p">;</span> <span class="c1">//n_e-extraordinary refractive index (root of permittivity parallel to z-axis, epara)</span>
<span class="kt">real</span> <span class="n">no</span> <span class="o">=</span> <span class="mf">1.46</span><span class="p">;</span> <span class="c1">//n_o-ordinary refractive index (root of permittivity orthogonal to z-axis, eorto)</span>
<span class="kt">real</span> <span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//refractive index of surrounding medium (air)</span>

<span class="kt">int</span> <span class="kp">nev</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// number of eigen values to find</span>

<span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">213</span><span class="p">;</span> <span class="c1">//azimuthal mode order ~ 2Pi*n*R/lambda</span>
<span class="kt">real</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//penalty term</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">W1l</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="o">+</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">-</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W1r</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="o">-</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="o">+</span><span class="p">(</span><span class="n">yt</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W3l</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="o">+</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">-</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W3r</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="o">-</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="o">-</span><span class="p">(</span><span class="n">yt</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">S</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">((</span><span class="kp">t</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angle</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nf">sin</span><span class="p">((</span><span class="kp">t</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angle</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">W1r</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W1l</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W4</span><span class="p">(</span><span class="n">Nm</span><span class="p">)</span> <span class="o">+</span> <span class="n">W3l</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W3r</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W2</span><span class="p">(</span><span class="n">Nm</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="n">Nm</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">WindowIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
<span class="n">Ph</span> <span class="n">reg</span> <span class="o">=</span> <span class="kr">region</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">ncav</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">xl</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// cavity</span>
<span class="kt">int</span> <span class="n">nair</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">//air</span>
<span class="n">Ph</span> <span class="n">eorto</span> <span class="o">=</span> <span class="n">no</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">ncav</span><span class="p">)</span> <span class="o">+</span> <span class="n">nm</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nair</span><span class="p">);</span> <span class="c1">//subdomains for epsilon values inside and outside the resonators</span>
<span class="n">Ph</span> <span class="n">epara</span> <span class="o">=</span> <span class="n">ne</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">ncav</span><span class="p">)</span> <span class="o">+</span> <span class="n">nm</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nair</span><span class="p">);</span> <span class="c1">//subdomains for epsilon values inside and outside the resonators</span>

<span class="c1">//supplementary variables to store eigenvectors, defined on mesh Th with P2 elements - Largange quadratic.</span>
<span class="kt">fespace</span> <span class="nf">Supp</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Supp</span> <span class="n">eHsqr</span><span class="p">;</span>

<span class="c1">//3d vector FE space</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">]);</span>
<span class="n">Vh</span> <span class="p">[</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">];</span> <span class="c1">//magnetic field components on Vh space and test functions vH</span>

<span class="c1">// Macro</span>
<span class="c1">//boundary condition macros</span>
<span class="kt">macro</span> <span class="nf">EWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span> <span class="p">(</span>
      <span class="nf">dy</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dx</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hr</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">-</span> <span class="n">epara</span><span class="o">*</span><span class="p">(</span><span class="n">Hz</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="p">)</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">MWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span> <span class="p">(</span>
      <span class="n">Hphi</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="p">(</span><span class="n">Hz</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span>
    <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span> <span class="p">)</span> <span class="c1">//</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="kp">sigma</span> <span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="p">(</span><span class="n">ne</span><span class="o">*</span><span class="n">radius</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span> <span class="c1">// value of the shift (k^2), where the modes will be found</span>
<span class="kt">varf</span> <span class="nf">b</span> <span class="p">([</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">])</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">Hr</span><span class="o">*</span><span class="n">vHr</span><span class="o">+</span><span class="n">Hphi</span><span class="o">*</span><span class="n">vHphi</span><span class="o">+</span><span class="n">Hz</span><span class="o">*</span><span class="n">vHz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">;</span>
<span class="c1">// OP = A - sigma B ; // the shifted matrix</span>
<span class="kt">varf</span> <span class="kp">op</span> <span class="p">([</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">])</span><span class="o">=</span>
    <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span>
              <span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">Hphi</span><span class="o">*</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHz</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span><span class="o">/</span><span class="kr">x</span> <span class="c1">//A/r</span>
            <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">vHr</span><span class="p">))</span> <span class="o">-</span> <span class="n">epara</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHz</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">vHphi</span><span class="p">))</span> <span class="c1">//B</span>
            <span class="o">+</span> <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="p">((</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHz</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHr</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hr</span><span class="p">))</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)))</span> <span class="c1">//C</span>
        <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="n">epara</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span>
              <span class="p">(</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">Hphi</span><span class="o">*</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span><span class="p">)</span><span class="o">/</span><span class="kr">x</span> <span class="c1">//D/r</span>
            <span class="o">+</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHz</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Hr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vHr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hz</span><span class="p">))</span> <span class="c1">//E</span>
            <span class="o">+</span> <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHz</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hz</span><span class="p">))</span> <span class="c1">//F</span>
        <span class="p">)</span>
        <span class="o">-</span><span class="kp">sigma</span><span class="o">*</span><span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span> <span class="o">+</span> <span class="n">vHz</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1">//electric wall boundary condition on the boundary of computation domain</span>
    <span class="o">+</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span>
          <span class="n">EWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span><span class="o">*</span><span class="n">EWall</span><span class="p">(</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">;</span>
<span class="c1">//setting sparce matrices and assigning the solver UMFPACK to solve eigenvalue problem</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">UMFPACK</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="n">OP</span> <span class="o">=</span> <span class="kp">op</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">UMFPACK</span><span class="p">);</span>

<span class="c1">// Solve</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ev</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvalue</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">eHr</span><span class="p">,</span> <span class="n">eHphi</span><span class="p">,</span> <span class="n">eHz</span><span class="p">](</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvector</span>
<span class="c1">//calling ARPACK on sparce matrices with the assigned solver UMFPACK:</span>
<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="n">OP</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="kp">sym</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="kp">sigma</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="kp">vector</span><span class="o">=</span><span class="n">eHr</span><span class="p">,</span> <span class="kp">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kp">maxit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">ncv</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="n">k</span> <span class="o">=</span> <span class="kr">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kp">nev</span><span class="p">);</span> <span class="c1">//sometimes the number of converged eigen values</span>
                 <span class="c1">//can be greater than nev</span>

<span class="c1">//file to output mode values</span>
<span class="kt">ofstream</span> <span class="nf">f</span><span class="p">(</span><span class="s">&quot;modes.txt&quot;</span><span class="p">);</span>
<span class="c1">//setting number of digits in the file output</span>
<span class="kt">int</span> <span class="n">nold</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="kr">precision</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span>

<span class="c1">// Plot &amp; Save</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kt">real</span> <span class="n">lambda</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="n">eHsqr</span> <span class="o">=</span> <span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">eHr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eHphi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eHz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="c1">//intensity from magnetic field components</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">eHsqr</span><span class="p">,</span> <span class="kp">WindowIndex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbiso</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">LabelColors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">aspectratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Mode &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot;, lambda=&quot;</span><span class="o">+</span><span class="n">lambda</span><span class="o">+</span><span class="s">&quot;, F=&quot;</span><span class="o">+</span><span class="p">(</span><span class="mf">299792.458</span><span class="o">/</span><span class="n">lambda</span><span class="p">));</span>
    <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Mode &quot;</span><span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, ka=&quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">radius</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


		</div>
		
		<div id="toc">
	<div>
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Whispering gallery modes</a><ul>
<li><a class="reference internal" href="#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li><a class="reference internal" href="#weak-formulation">Weak formulation</a></li>
<li><a class="reference internal" href="#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>

	</div>
</div>
		<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation/" target="_blank">BibTeX</a>
	</div>
</footer>
		

		<script async src="../_static/js/common.js"></script>
	</body>
</html>




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="FreeFEM++ documentation">
      
      
        <link rel="canonical" href="https://doc.freefem.org/models/WhisperingGalleryModes/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Whispering gallery modes - FreeFem++ documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#wave-equation-for-the-wgms" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://doc.freefem.org" title="FreeFem++ documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/favicon.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              FreeFem++ documentation
            </span>
            <span class="md-header-nav__topic">
              Whispering gallery modes
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/FreeFem/FreeFem-doc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    FreeFem++ on Github
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Introduction" class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../documentation/" title="Documentation" class="md-tabs__link">
          Documentation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../reference/" title="Language References" class="md-tabs__link">
          Language References
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/" title="Tutorials" class="md-tabs__link">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../examples/" title="Examples" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Models" class="md-tabs__link md-tabs__link--active">
          Models
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://doc.freefem.org" title="FreeFem++ documentation" class="md-nav__button md-logo">
      
        <img src="../../images/favicon.png" width="48" height="48">
      
    </a>
    FreeFem++ documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/FreeFem/FreeFem-doc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    FreeFem++ on Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/contributing/" title="How to contribute?" class="md-nav__link">
      How to contribute?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/citation/" title="Citation" class="md-nav__link">
      Citation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/authors/" title="Authors" class="md-nav__link">
      Authors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Notations/" title="Some Notations" class="md-nav__link">
      Some Notations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/MeshGeneration/" title="Mesh Generation" class="md-nav__link">
      Mesh Generation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/FiniteElement/" title="Finite Element" class="md-nav__link">
      Finite Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/AlgorithmsOptimization/" title="Algorithms & Optimization" class="md-nav__link">
      Algorithms & Optimization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Parallelization/" title="Parallelization" class="md-nav__link">
      Parallelization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8">
    
    <label class="md-nav__link" for="nav-2-8">
      ffddm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        ffddm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/ffddm/ffddm/" title="What is ffddm ?" class="md-nav__link">
      What is ffddm ?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/ffddm/tutorial-slides.html" title="Tutorial slides" class="md-nav__link">
      Tutorial slides
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/ffddm/introddm/" title="Introduction to DDM" class="md-nav__link">
      Introduction to DDM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/ffddm/documentation/" title="ffddm Documentation" class="md-nav__link">
      ffddm Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/ffddm/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/Developers/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Language References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Language References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Types/" title="Types" class="md-nav__link">
      Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/GlobalVariables/" title="Global variables" class="md-nav__link">
      Global variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/QuadratureFormulae/" title="Quadrature formulae" class="md-nav__link">
      Quadrature formulae
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Operators/" title="Operators" class="md-nav__link">
      Operators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Loops/" title="Loops" class="md-nav__link">
      Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/IO/" title="I/O" class="md-nav__link">
      I/O
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/Functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/ExternalLibraries/" title="External libraries" class="md-nav__link">
      External libraries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Poisson/" title="Poisson's equation" class="md-nav__link">
      Poisson's equation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/EquationsClassification/" title="Classification of the equations" class="md-nav__link">
      Classification of the equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Membrane/" title="Membrane" class="md-nav__link">
      Membrane
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/HeatExchanger/" title="Heat Exchanger" class="md-nav__link">
      Heat Exchanger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Acoustics/" title="Acoustics" class="md-nav__link">
      Acoustics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ThermalConduction/" title="Thermal Conduction" class="md-nav__link">
      Thermal Conduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/FanBlade/" title="Irrotational Fan Blade Flow and Thermal effects" class="md-nav__link">
      Irrotational Fan Blade Flow and Thermal effects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/RotatingHill/" title="Pure convection, The rotating hill" class="md-nav__link">
      Pure convection, The rotating hill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Elasticity/" title="The system of elasticity" class="md-nav__link">
      The system of elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/Stokes/" title="The system of Stokes for fluids" class="md-nav__link">
      The system of Stokes for fluids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/NavierStokesProjection/" title="A projection Algorithm for the Navier-Stokes equations" class="md-nav__link">
      A projection Algorithm for the Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/NavierStokesNewton/" title="Newton method for the steady Navier-Stokes equations" class="md-nav__link">
      Newton method for the steady Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ALargeFluidProblem/" title="A large fluid problem" class="md-nav__link">
      A large fluid problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ComplexNumbers/" title="An example with complex numbers" class="md-nav__link">
      An example with complex numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/OptimalControl/" title="Optimal control" class="md-nav__link">
      Optimal control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/FlowWithShocks/" title="A flow with shocks" class="md-nav__link">
      A flow with shocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/HeatEquationOptimization/" title="Time dependent schema optimization for heat equations" class="md-nav__link">
      Time dependent schema optimization for heat equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/TimeDependentStokes/" title="A transient Stokes solver in matrix form" class="md-nav__link">
      A transient Stokes solver in matrix form
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/WifiPropagation/" title="Wifi Propagation" class="md-nav__link">
      Wifi Propagation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/MatlabOctavePlot/" title="Matlab / Octave Plots" class="md-nav__link">
      Matlab / Octave Plots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../StaticProblems/" title="Static problems" class="md-nav__link">
      Static problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Elasticity/" title="Elasticity" class="md-nav__link">
      Elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NonLinearStaticProblems/" title="Non-linear static problems" class="md-nav__link">
      Non-linear static problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EigenValueProblems/" title="Eigenvalue problems" class="md-nav__link">
      Eigenvalue problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EvolutionProblems/" title="Evolution problems" class="md-nav__link">
      Evolution problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NavierStokesEquations/" title="Navier-Stokes equations" class="md-nav__link">
      Navier-Stokes equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../VariationalInequality/" title="Variational inequality" class="md-nav__link">
      Variational inequality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DomainDecomposition/" title="Domain decomposition" class="md-nav__link">
      Domain decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FluidStructureCoupledProblem/" title="Fluid-Structure coupled problem" class="md-nav__link">
      Fluid-Structure coupled problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TransmissionProblem/" title="Transmission problem" class="md-nav__link">
      Transmission problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FreeBoundaryProblem/" title="Free boundary problem" class="md-nav__link">
      Free boundary problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NonLinearElasticity/" title="Non-linear elasticity" class="md-nav__link">
      Non-linear elasticity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CompressibleNeoHookeanMaterials/" title="Compressible Neo-Hookean materials" class="md-nav__link">
      Compressible Neo-Hookean materials
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Whispering gallery modes
      </label>
    
    <a href="./" title="Whispering gallery modes" class="md-nav__link md-nav__link--active">
      Whispering gallery modes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wave-equation-for-the-wgms" title="Wave equation for the WGMs" class="md-nav__link">
    Wave equation for the WGMs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weak-formulation" title="Weak formulation" class="md-nav__link">
    Weak formulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-dielectric-sphere-example-with-freefem" title="A dielectric sphere example with FreeFem++" class="md-nav__link">
    A dielectric sphere example with FreeFem++
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TODO/" title="TODO" class="md-nav__link">
      TODO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wave-equation-for-the-wgms" title="Wave equation for the WGMs" class="md-nav__link">
    Wave equation for the WGMs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weak-formulation" title="Weak formulation" class="md-nav__link">
    Weak formulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-dielectric-sphere-example-with-freefem" title="A dielectric sphere example with FreeFem++" class="md-nav__link">
    A dielectric sphere example with FreeFem++
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/FreeFem/FreeFem-doc/edit/master/docs/models/WhisperingGalleryModes.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Whispering gallery modes</h1>
                
                <p><em>Written by <a href="http://grudinin.com/">I. S. Grudinin</a></em></p>
<p>In whispering gallery mode (WGM) resonators, which are typically spheres or disks, electromagnetic field is trapped by total internal reflections from the boundary. Modes of such resonators are distinguished by compact volume and record high quality factors (Q) in a broad range of frequencies.</p>
<p>Modern applications of such resonators include microwave and optical cavities for atomic clocks, cavity optomechanics, nonlinear and quantum optics. Analytical solutions for WG modes are only available for a limited number of idealized geometries, such as sphere or ellipsoid. Since resonator dimensions are typically much larger than optical wavelength, direct application of numerical 3D finite difference time domain (FDTD) or finite element methods (FEM) is not practical. It's possible to solve the vectorial wave equation by reducing it to a two dimensional case by taking axial symmetry into account.</p>
<p>Such reduction leads to a system of 3 equations to be solved in a 2D "<span><span class="MathJax_Preview">\rho-z</span><script type="math/tex">\rho-z</script></span>" section of a resonator. Please refer to <a href="#OXBORROW2007">OXBORROW2007</a> for a detailed derivation and to <a href="#GRUDININ2012">GRUDININ2012</a> for an example of using FreeFem++ to compute WGMs.</p>
<h2 id="wave-equation-for-the-wgms">Wave equation for the WGMs<a class="headerlink" href="#wave-equation-for-the-wgms" title="Permanent link">#</a></h2>
<p>Since electric field is discontinuous on the surface of a dielectric and magnetic field is typically not, we derive our equations for the magnetic field. The electric field can be easily derived at a later stage from <span><span class="MathJax_Preview">\vec{E}=\frac{i}{\omega\epsilon_0}\hat{\epsilon}^{-1}\nabla\times\vec{H}</span><script type="math/tex">\vec{E}=\frac{i}{\omega\epsilon_0}\hat{\epsilon}^{-1}\nabla\times\vec{H}</script></span>. Following a standard procedure starting with Maxwell equations we derive a wave equation in a single-axis anisotropic medium such as an optical crystal:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\label{eqn::wave}
\nabla\times\left(\hat{\epsilon}^{-1}\nabla\times\vec{H}\right)-k_0^2\vec{H}-\alpha\nabla\left(\nabla\cdot\vec{H}\right)=0
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\label{eqn::wave}
\nabla\times\left(\hat{\epsilon}^{-1}\nabla\times\vec{H}\right)-k_0^2\vec{H}-\alpha\nabla\left(\nabla\cdot\vec{H}\right)=0
\end{equation}</script>
</div>
<p>Here <span><span class="MathJax_Preview">k_0=\omega/c</span><script type="math/tex">k_0=\omega/c</script></span> is the wavenumber, <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> is the penalty term added to fight spurious FEM solutions.  For anisotropic single-axis medium with <span><span class="MathJax_Preview">\partial\hat{\epsilon}/\partial\phi=0</span><script type="math/tex">\partial\hat{\epsilon}/\partial\phi=0</script></span> in cylindrical system of coordinates we have:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\hat{\epsilon}=\begin{pmatrix} \epsilon_{\rho} &amp; 0 &amp; 0 \\ 0 &amp; \epsilon_{\rho} &amp; 0 \\ 0 &amp; 0 &amp; \epsilon_z \end{pmatrix}. \nonumber
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\hat{\epsilon}=\begin{pmatrix} \epsilon_{\rho} & 0 & 0 \\ 0 & \epsilon_{\rho} & 0 \\ 0 & 0 & \epsilon_z \end{pmatrix}. \nonumber
\end{equation}</script>
</div>
<p>We now assume axial symmetry of our electromagnetic fields and insert an imaginary unity in front of the <span><span class="MathJax_Preview">H_{\phi}</span><script type="math/tex">H_{\phi}</script></span> to allow all field components to be real numbers and also to account for the phase shift of this component <span><span class="MathJax_Preview">\vec{H}(\rho,\phi,z)=\left\{H_{\rho}(\rho,z),iH_{\phi}(\rho,z),H_z(\rho,z)\right\}\times e^{im\phi}</span><script type="math/tex">\vec{H}(\rho,\phi,z)=\left\{H_{\rho}(\rho,z),iH_{\phi}(\rho,z),H_z(\rho,z)\right\}\times e^{im\phi}</script></span>.</p>
<p>We write the wave equation \eqref{eqn::wave} explicitly in cylindrical coordinates, thus obtaining a set of three differential equations for the domain <span><span class="MathJax_Preview">\Omega</span><script type="math/tex">\Omega</script></span> given by the resonator's cross section and some space outside:</p>
<div>
<div class="MathJax_Preview">\begin{eqnarray}
\label{eqn::system}
A_1\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0\\ \nonumber
A_2\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0\\ \nonumber
A_3\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&amp;=&amp;0
\end{eqnarray}</div>
<script type="math/tex; mode=display">\begin{eqnarray}
\label{eqn::system}
A_1\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&=&0\\ \nonumber
A_2\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&=&0\\ \nonumber
A_3\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}&=&0
\end{eqnarray}</script>
</div>
<p>The numerical solutions of these equations and boundary conditions can be found with FreeFem++ if we write the system in the weak, or integral form.</p>
<h2 id="weak-formulation">Weak formulation<a class="headerlink" href="#weak-formulation" title="Permanent link">#</a></h2>
<p>In general, to obtain the integral or "weak" statements equivalent to system \eqref{eqn::system} and boundary conditions we form a scalar dot product between an arbitrary magnetic field test function <span><span class="MathJax_Preview">\mathbf{H}^t=\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}</span><script type="math/tex">\mathbf{H}^t=\{{H}_{\rho}^t,{H}_{\phi}^t,{H}_{z}^t\}</script></span> and the components of our vectorial equation <span><span class="MathJax_Preview">A_1,A_2,A_3</span><script type="math/tex">A_1,A_2,A_3</script></span>, and integrate over the resonator's cross section domain <span><span class="MathJax_Preview">\Omega</span><script type="math/tex">\Omega</script></span> (and its boundary for the boundary conditions):</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \int\limits_{\Omega}(H^t_{\rho}A_1+H^t_{\phi}A_2+H^t_{z}A_3)d\Omega
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \int\limits_{\Omega}(H^t_{\rho}A_1+H^t_{\phi}A_2+H^t_{z}A_3)d\Omega
\end{equation}</script>
</div>
<p>We can reduce the order of partial derivatives in this integral by using the Green's formula for integration by parts. For example:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\int\limits_{\Omega}H_z^t \frac{\partial^2 H_z}{\partial \rho^2 }d\Omega=
-\int\limits_{\Omega}\frac{\partial H_z^t}{\partial \rho}\frac{\partial H_z}{\partial \rho }d\Omega+\oint H_z^t\frac{\partial H_z}{\partial \rho}n_{\rho}d\Gamma
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\int\limits_{\Omega}H_z^t \frac{\partial^2 H_z}{\partial \rho^2 }d\Omega=
-\int\limits_{\Omega}\frac{\partial H_z^t}{\partial \rho}\frac{\partial H_z}{\partial \rho }d\Omega+\oint H_z^t\frac{\partial H_z}{\partial \rho}n_{\rho}d\Gamma
\end{equation}</script>
</div>
<p>Thus converting equations \eqref{eqn::system} we obtain a large expression for the weak form.</p>
<h2 id="a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFem++<a class="headerlink" href="#a-dielectric-sphere-example-with-freefem" title="Permanent link">#</a></h2>
<p>We now compute the fundamental mode frequency for a fused silica sphere. The sphere is 36 micrometer in diameter, the refractive index is 1.46, the boundary condition is the magnetic wall (which can actually be omitted as it holds automatically).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">radius</span> <span class="o">=</span> <span class="mi">36</span><span class="p">;</span> <span class="c1">//approximate radius of the cavity</span>
<span class="kt">real</span> <span class="n">yb</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">yt</span> <span class="o">=</span> <span class="o">-</span><span class="n">yb</span><span class="p">;</span> <span class="c1">//window yb=bottom and yt=top coordinates</span>
<span class="kt">real</span> <span class="n">xl</span> <span class="o">=</span> <span class="n">radius</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">xr</span> <span class="o">=</span> <span class="n">radius</span><span class="o">+</span><span class="mi">3</span><span class="p">;</span> <span class="c1">//window xl=left and xr=right coordinates</span>
<span class="kt">real</span> <span class="n">angle</span> <span class="o">=</span> <span class="nf">asin</span><span class="p">((</span><span class="n">yt</span><span class="p">)</span><span class="o">/</span><span class="n">radius</span><span class="p">);</span> <span class="c1">//angle of the sphere segment to model in radians</span>
<span class="kt">int</span> <span class="n">Nm</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span> <span class="c1">//number of mesh vertices per border</span>
<span class="kt">real</span> <span class="n">ne</span> <span class="o">=</span> <span class="mf">1.46</span><span class="p">;</span> <span class="c1">//n_e-extraordinary refractive index (root of permittivity parallel to z-axis, epara)</span>
<span class="kt">real</span> <span class="n">no</span> <span class="o">=</span> <span class="mf">1.46</span><span class="p">;</span> <span class="c1">//n_o-ordinary refractive index (root of permittivity orthogonal to z-axis, eorto)</span>
<span class="kt">real</span> <span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//refractive index of surrounding medium (air)</span>

<span class="kt">int</span> <span class="kp">nev</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// number of eigen values to find</span>

<span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">213</span><span class="p">;</span> <span class="c1">//azimuthal mode order ~ 2Pi*n*R/lambda</span>
<span class="kt">real</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//penalty term</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">W1l</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="o">+</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">-</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W1r</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="o">-</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="o">+</span><span class="p">(</span><span class="n">yt</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W3l</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="o">+</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">-</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W3r</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xr</span><span class="o">-</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">yb</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">W4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">xl</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">yt</span><span class="o">-</span><span class="p">(</span><span class="n">yt</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">S</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nf">cos</span><span class="p">((</span><span class="kp">t</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angle</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nf">sin</span><span class="p">((</span><span class="kp">t</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angle</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">W1r</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W1l</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W4</span><span class="p">(</span><span class="n">Nm</span><span class="p">)</span> <span class="o">+</span> <span class="n">W3l</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W3r</span><span class="p">(</span><span class="n">Nm</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">W2</span><span class="p">(</span><span class="n">Nm</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="n">Nm</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">WindowIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
<span class="n">Ph</span> <span class="n">reg</span> <span class="o">=</span> <span class="kr">region</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">ncav</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">xl</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// cavity</span>
<span class="kt">int</span> <span class="n">nair</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">xr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">//air</span>
<span class="n">Ph</span> <span class="n">eorto</span> <span class="o">=</span> <span class="n">no</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">ncav</span><span class="p">)</span> <span class="o">+</span> <span class="n">nm</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nair</span><span class="p">);</span> <span class="c1">//subdomains for epsilon values inside and outside the resonators</span>
<span class="n">Ph</span> <span class="n">epara</span> <span class="o">=</span> <span class="n">ne</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">ncav</span><span class="p">)</span> <span class="o">+</span> <span class="n">nm</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nair</span><span class="p">);</span> <span class="c1">//subdomains for epsilon values inside and outside the resonators</span>

<span class="c1">//supplementary variables to store eigenvectors, defined on mesh Th with P2 elements - Largange quadratic.</span>
<span class="kt">fespace</span> <span class="nf">Supp</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Supp</span> <span class="n">eHsqr</span><span class="p">;</span>

<span class="c1">//3d vector FE space</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">]);</span>
<span class="n">Vh</span> <span class="p">[</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">];</span> <span class="c1">//magnetic field components on Vh space and test functions vH</span>

<span class="c1">// Macro</span>
<span class="c1">//boundary condition macros</span>
<span class="kt">macro</span> <span class="nf">EWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span> <span class="p">(</span>
      <span class="nf">dy</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dx</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hr</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">-</span> <span class="n">epara</span><span class="o">*</span><span class="p">(</span><span class="n">Hz</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="p">)</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">MWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span> <span class="p">(</span>
      <span class="n">Hphi</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span>
    <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="p">(</span><span class="n">Hz</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span>
    <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">Hr</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span> <span class="p">)</span> <span class="c1">//</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="kp">sigma</span> <span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="p">(</span><span class="n">ne</span><span class="o">*</span><span class="n">radius</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span> <span class="c1">// value of the shift (k^2), where the modes will be found</span>
<span class="kt">varf</span> <span class="nf">b</span> <span class="p">([</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">])</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">Hr</span><span class="o">*</span><span class="n">vHr</span><span class="o">+</span><span class="n">Hphi</span><span class="o">*</span><span class="n">vHphi</span><span class="o">+</span><span class="n">Hz</span><span class="o">*</span><span class="n">vHz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">;</span>
<span class="c1">// OP = A - sigma B ; // the shifted matrix</span>
<span class="kt">varf</span> <span class="kp">op</span> <span class="p">([</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">],</span> <span class="p">[</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">])</span><span class="o">=</span>
    <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span>
              <span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">Hphi</span><span class="o">*</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHz</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span><span class="o">/</span><span class="kr">x</span> <span class="c1">//A/r</span>
            <span class="o">+</span> <span class="n">eorto</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Hphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">vHr</span><span class="p">))</span> <span class="o">-</span> <span class="n">epara</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHz</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hz</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">vHphi</span><span class="p">))</span> <span class="c1">//B</span>
            <span class="o">+</span> <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="n">epara</span><span class="o">*</span><span class="p">((</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHz</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHr</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span> <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hr</span><span class="p">))</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">Hphi</span><span class="p">)))</span> <span class="c1">//C</span>
        <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eorto</span><span class="o">*</span><span class="n">epara</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span>
              <span class="p">(</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">Hphi</span><span class="o">*</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="n">M</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span><span class="p">)</span><span class="o">/</span><span class="kr">x</span> <span class="c1">//D/r</span>
            <span class="o">+</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHz</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Hr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">Hphi</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vHr</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">vHphi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hz</span><span class="p">))</span> <span class="c1">//E</span>
            <span class="o">+</span> <span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">vHr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vHz</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Hr</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Hz</span><span class="p">))</span> <span class="c1">//F</span>
        <span class="p">)</span>
        <span class="o">-</span><span class="kp">sigma</span><span class="o">*</span><span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="n">vHr</span><span class="o">*</span><span class="n">Hr</span> <span class="o">+</span> <span class="n">vHphi</span><span class="o">*</span><span class="n">Hphi</span> <span class="o">+</span> <span class="n">vHz</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1">//electric wall boundary condition on the boundary of computation domain</span>
    <span class="o">+</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span>
          <span class="n">EWall</span><span class="p">(</span><span class="n">Hr</span><span class="p">,</span> <span class="n">Hphi</span><span class="p">,</span> <span class="n">Hz</span><span class="p">)</span><span class="o">*</span><span class="n">EWall</span><span class="p">(</span><span class="n">vHr</span><span class="p">,</span> <span class="n">vHphi</span><span class="p">,</span> <span class="n">vHz</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">;</span>
<span class="c1">//setting sparce matrices and assigning the solver UMFPACK to solve eigenvalue problem</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">UMFPACK</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="n">OP</span> <span class="o">=</span> <span class="kp">op</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">UMFPACK</span><span class="p">);</span>

<span class="c1">// Solve</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ev</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvalue</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">eHr</span><span class="p">,</span> <span class="n">eHphi</span><span class="p">,</span> <span class="n">eHz</span><span class="p">](</span><span class="kp">nev</span><span class="p">);</span> <span class="c1">//to store the nev eigenvector</span>
<span class="c1">//calling ARPACK on sparce matrices with the assigned solver UMFPACK:</span>
<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">EigenValue</span><span class="p">(</span><span class="n">OP</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="kp">sym</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="kp">sigma</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="kp">vector</span><span class="o">=</span><span class="n">eHr</span><span class="p">,</span> <span class="kp">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kp">maxit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">ncv</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="n">k</span> <span class="o">=</span> <span class="kr">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kp">nev</span><span class="p">);</span> <span class="c1">//sometimes the number of converged eigen values</span>
                 <span class="c1">//can be greater than nev</span>

<span class="c1">//file to output mode values</span>
<span class="kt">ofstream</span> <span class="nf">f</span><span class="p">(</span><span class="s">&quot;modes.txt&quot;</span><span class="p">);</span>
<span class="c1">//setting number of digits in the file output</span>
<span class="kt">int</span> <span class="n">nold</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="kr">precision</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span>

<span class="c1">// Plot &amp; Save</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kt">real</span> <span class="n">lambda</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="n">eHsqr</span> <span class="o">=</span> <span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">eHr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eHphi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eHz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="c1">//intensity from magnetic field components</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">eHsqr</span><span class="p">,</span> <span class="kp">WindowIndex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbiso</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">LabelColors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">aspectratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Mode &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot;, lambda=&quot;</span><span class="o">+</span><span class="n">lambda</span><span class="o">+</span><span class="s">&quot;, F=&quot;</span><span class="o">+</span><span class="p">(</span><span class="mf">299792.458</span><span class="o">/</span><span class="n">lambda</span><span class="p">));</span>
    <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Mode &quot;</span><span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, ka=&quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">radius</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h2>
<p><a name="OXBORROW2007">[OXBORROW2007]</a> OXBORROW, Mark. Traceable 2-D finite-element simulation of the whispering-gallery modes of axisymmetric electromagnetic resonators. IEEE Transactions on Microwave Theory and Techniques, 2007, vol. 55, no 6, p. 1209-1218.</p>
<p><a name="GRUDININ2012">[GRUDININ2012]</a> GRUDININ, Ivan S. et YU, Nan. Finite-element modeling of coupled optical microdisk resonators for displacement sensing. JOSA B, 2012, vol. 29, no 11, p. 3010-3014.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../CompressibleNeoHookeanMaterials/" title="Compressible Neo-Hookean materials" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Compressible Neo-Hookean materials
              </span>
            </div>
          </a>
        
        
          <a href="../TODO/" title="TODO" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                TODO
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/FreeFem/FreeFem-doc" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_CHTML"></script>
      
        <script src="../../mathjax-config.js"></script>
      
    
  </body>
</html>
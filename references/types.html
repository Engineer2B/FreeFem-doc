<!DOCTYPE html>

<html lang="en">
	<head>
		  <meta charset="UTF-8">
  <title>Types</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- MathJax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <script src="../_static/js/mathjax-config.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-sources" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
<script async src="../_static/js/github.js"></script>
		
		<nav id="nav">
	<div style="display: none;">
		<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFEM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#easy-installation">Easy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-binary-installation">Windows binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-binary-installation">MacOS X binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#text-editor">Text-editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compilation">Compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#branches-os-status">Branches / OS status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation/notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#square">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#border">Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#multi-border">Multi-Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#the-keyword-triangulate">The keyword “triangulate”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#boundary-fem-spaces-built-as-empty-meshes">Boundary FEM Spaces Built as Empty Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#remeshing">Remeshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#movemesh">Movemesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#regular-triangulation-htriangle">Regular Triangulation: hTriangle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#adaptmesh">Adaptmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#trunc">Trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#splitmesh">Splitmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#meshing-examples">Meshing Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">How to change the label of elements and border elements of a mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mesh-in-three-dimensions">Mesh in three dimensions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#layer-mesh">Layer mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#meshing-examples-1">Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/meshGeneration.html#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#medit">Medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mshmet">Mshmet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#freeyams">FreeYams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#mmg3d">mmg3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/meshGeneration.html#build-a-2d-mesh-from-a-isoline">Build a 2d mesh from a isoline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/finiteElement.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#use-of-freefem-fespace-in-2d">Use of freefem fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/finiteElement.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/finiteElement.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/algorithmsOptimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/algorithmsOptimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/algorithmsOptimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#hpddm-solvers">HPDDM solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#time-dependent-problem">Time dependent problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/parallelization.html#distributed-vectors-in-hpddm">Distributed vectors in HPDDM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/introddm.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/introddm.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/introddm.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../documentation/ffddm/introddm.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="../documentation/ffddm/introddm.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="../documentation/ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation/ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation/ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation/ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../example/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/finiteElement.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/algoOptimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr/lunr_index.js"></script>

<div class="search-container">
	<label for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Search ..." id="searchInput">
	<div id="searchResults"></div>
</div>

<script src="../_static/js/search.js"></script>
<script>
   initSearch('../')
</script>
	
</nav>
<script async src="../_static/js/nav.js"></script>
		

		<div id="subnav">
	<div style="display: none">
		<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
</ul>

	</div>
</div>
<script async src="../_static/js/subnav.js"></script>
		
		<div id="content">
			
   <div class="section" id="types">
<span id="referencetypes"></span><h1>Types<a class="headerlink" href="#types" title="Permalink to this headline"> </a></h1>
<div class="section" id="standard-types">
<h2>Standard types<a class="headerlink" href="#standard-types" title="Permalink to this headline"> </a></h2>
<div class="section" id="int">
<h3>int<a class="headerlink" href="#int" title="Permalink to this headline"> </a></h3>
<p>Integer value (equivalent to <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">long</span></code> in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bool">
<h3>bool<a class="headerlink" href="#bool" title="Permalink to this headline"> </a></h3>
<p>Boolean value.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="n">b</span> <span class="o">=</span> <span class="kr">true</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The result of a comparison is a boolean</p>
<p class="last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">bool</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">);</span></code></p>
</div>
</div>
<div class="section" id="real">
<h3>real<a class="headerlink" href="#real" title="Permalink to this headline"> </a></h3>
<p>Real value (equivalent to <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">double</span></code> in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="complex">
<h3>complex<a class="headerlink" href="#complex" title="Permalink to this headline"> </a></h3>
<p>Complex value (equivalent to two <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">double</span></code> or <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">complex</span><span class="p">&lt;</span><span class="n">double</span><span class="p">&gt;</span></code> in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">complex</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The imaginary number <span class="math notranslate nohighlight">\(i\)</span> is defined as <code class="docutils literal highlight highlight-freefem"><span></span><span class="mi">1</span><span class="n">i</span></code></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Example</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">complex</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="n">i</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a + b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a - b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a*b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a/b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The output of this script is:</p>
<div class="last highlight-bash notranslate"><div class="highlight"><pre><span></span>a + <span class="nv">b</span> <span class="o">=</span> <span class="o">(</span><span class="m">2</span>,4<span class="o">)</span>
a - <span class="nv">b</span> <span class="o">=</span> <span class="o">(</span>-2,-2<span class="o">)</span>
a*b <span class="o">=</span> <span class="o">(</span>-3,2<span class="o">)</span>
a/b <span class="o">=</span> <span class="o">(</span><span class="m">0</span>.230769,0.153846<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="../example/developers.html#examplecomplex"><span class="std std-ref">Complex example</span></a> for a detailed example.</p>
</div>
</div>
<div class="section" id="string">
<h3>string<a class="headerlink" href="#string" title="Permalink to this headline"> </a></h3>
<p>String value.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;this is a string&quot;</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> value is enclosed within double quotes.</p>
</div>
<p>Other types can be concatenate to a string, like:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;the int i = &quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span><span class="s">&quot;, the real r = &quot;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&quot;, the complex z = &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>To append a string in a string at position 4:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;+++&quot;</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>To copy a substring in an other string:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">string</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="p">(</span><span class="mi">5</span><span class="o">:</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>See <a class="reference internal" href="../example/developers.html#examplestring"><span class="std std-ref">String Example</span></a> for a complete example.</p>
</div>
</div>
<div class="section" id="mesh-design">
<h2>Mesh design<a class="headerlink" href="#mesh-design" title="Permalink to this headline"> </a></h2>
<div class="section" id="border">
<h3>border<a class="headerlink" href="#border" title="Permalink to this headline"> </a></h3>
<p>Border type.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);}</span>
</pre></div>
</td></tr></table></div>
<p>Define the 2D geometrical border in parametric coordinates.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Label</p>
<p>A label can be defined with the border:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Inner variable</p>
<p>An inner variable can be defined inside a border:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kt">real</span> <span class="n">tt</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="n">tt</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="n">tt</span><span class="p">);}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>From vector</p>
<p>A border can be defined from two vectors using :freefem`P.x` and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span><span class="p">.</span><span class="kr">y</span></code>:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vectorX</span><span class="p">.</span><span class="kr">n</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">vectorX</span><span class="p">[</span><span class="kp">t</span><span class="p">];</span> <span class="kr">P</span><span class="p">.</span><span class="kr">x</span><span class="o">=</span><span class="n">vectorY</span><span class="p">[</span><span class="kp">t</span><span class="p">];}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="mesh">
<h3>mesh<a class="headerlink" href="#mesh" title="Permalink to this headline"> </a></h3>
<p>2D Mesh type (see <a class="reference internal" href="../documentation/meshGeneration.html#meshgeneration"><span class="std std-ref">Mesh Generation</span></a>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="mesh3">
<h3>mesh3<a class="headerlink" href="#mesh3" title="Permalink to this headline"> </a></h3>
<p>3D mesh type (see <a class="reference internal" href="../documentation/meshGeneration.html#meshgeneration"><span class="std std-ref">Mesh Generation</span></a>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Th</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="finite-element-space-design">
<h2>Finite element space design<a class="headerlink" href="#finite-element-space-design" title="Permalink to this headline"> </a></h2>
<div class="section" id="fespace">
<h3>fespace<a class="headerlink" href="#fespace" title="Permalink to this headline"> </a></h3>
<p>Finite element space type (see <a class="reference internal" href="../documentation/finiteElement.html#finiteelement"><span class="std std-ref">Finite Element</span></a>).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Uh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="kt">fespace</span> <span class="nf">UPh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]);</span>
</pre></div>
</td></tr></table></div>
<p>A finite element space is based on a mesh (<code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>) with an element definition, scalar (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span></code>) or vector (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]</span></code>).</p>
<p><strong>Available finite element space:</strong></p>
<p>Generic:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0</span> <span class="o">/</span> <span class="nc">P03d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span> <span class="o">/</span> <span class="nc">P13d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1dc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1b</span> <span class="o">/</span> <span class="nc">P1b3d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1bl</span> <span class="o">/</span> <span class="nc">P1bl3d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1nc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2</span> <span class="o">/</span> <span class="nc">P23d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2b</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2dc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2h</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT0</span> <span class="o">/</span> <span class="nc">RT03d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT0Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge03d</span></code></li>
</ul>
<p>Using <em>Element_P3</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3</span></code></li>
</ul>
<p>Using <em>Element_P3dc</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3dc</span></code></li>
</ul>
<p>Using <em>Element_P4</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4</span></code></li>
</ul>
<p>Using <em>Element_P4dc</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4dc</span></code></li>
</ul>
<p>Using <em>Element_PkEdge</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P5Edge</span></code></li>
</ul>
<p>Using <em>Morlay</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2Morley</span></code></li>
</ul>
<p>Using <em>HCT</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">HCT</span></code></li>
</ul>
<p>Using <em>BernardiRaugel</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2BR</span></code></li>
</ul>
<p>Using <em>Element_Mixte</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT1</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT1Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT2</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT2Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">BDM1</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">BDM1Ortho</span></code></li>
</ul>
<p>Using <em>Element_Mixte3d</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge13d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge23d</span></code></li>
</ul>
<p>Using <em>Element_QF</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">FEQF</span></code></li>
</ul>
<p>A finite element function is defined as follow:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Uh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Uh</span> <span class="n">u</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">UPh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]);</span>
<span class="n">UPh</span> <span class="p">[</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">,</span> <span class="n">p</span><span class="p">];</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="macro-design">
<span id="typemacrodesign"></span><h2>Macro design<a class="headerlink" href="#macro-design" title="Permalink to this headline"> </a></h2>
<div class="section" id="macro">
<h3>macro<a class="headerlink" href="#macro" title="Permalink to this headline"> </a></h3>
<p>Macro type.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="n">vU</span><span class="p">()</span> <span class="p">[</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">]</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">//</span>
</pre></div>
</td></tr></table></div>
<p>Macro ends with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="c1">//</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Macro concatenation</p>
<p>You can use the C concatenation operator <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="c">##</span></code> inside a macro using <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">#</span><span class="cp"></span></code>.</p>
<p>If <cite>Ux</cite> and <cite>Uy</cite> are defined as finite element function, you can define:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="n">Grad</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="p">[</span><span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">x</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">y</span><span class="p">)]</span> <span class="c1">// End of macro</span>
</pre></div>
</td></tr></table></div>
</div>
<p>See <a class="reference internal" href="../example/developers.html#examplemacro"><span class="std std-ref">Macro example</span></a></p>
</div>
<div class="section" id="newmacro-endmacro">
<h3>NewMacro / EndMacro<a class="headerlink" href="#newmacro-endmacro" title="Permalink to this headline"> </a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In developement - Not tested</p>
</div>
<p>Set and end a macro</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">NewMacro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="kt">EndMacro</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="ifmacro">
<h3>IFMACRO<a class="headerlink" href="#ifmacro" title="Permalink to this headline"> </a></h3>
<p>Check if a macro exists and check its value.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">IFMACRO</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span> <span class="c1">//check if macro AA exists</span>
<span class="p">...</span>
<span class="cp">ENDIFMACRO</span>

<span class="cp">IFMACRO</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span> <span class="c1">//check if amcro exists and is equall to tt</span>
<span class="p">...</span>
<span class="cp">ENDIFMACRO</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="endifmacro">
<h3>ENDIFMACRO<a class="headerlink" href="#endifmacro" title="Permalink to this headline"> </a></h3>
</div>
</div>
<div class="section" id="functions-design">
<h2>Functions design<a class="headerlink" href="#functions-design" title="Permalink to this headline"> </a></h2>
<div class="section" id="func">
<h3>func<a class="headerlink" href="#func" title="Permalink to this headline"> </a></h3>
<p>Function type.</p>
<p>Function without parameters (<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are implicitly considered):</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Function’s type is defined by the expression’s type.</p>
</div>
<p>Function with parameters:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span> <span class="nf">f</span> <span class="p">(</span><span class="kt">real</span> <span class="n">var</span><span class="p">){</span>
    <span class="k">return</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">var</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="elementary-functions">
<span id="typeelementaryfunctions"></span><h3>Elementary functions<a class="headerlink" href="#elementary-functions" title="Permalink to this headline"> </a></h3>
<p>Class of basic functions (polynomials, exponential, logarithmic, trigonometric, circular) and the functions obtained from those by the four arithmetic operations</p>
<div class="math notranslate nohighlight">
\[f(x) + g(x),\, f(x) - g(x),\, f(x)g(x),\, f(x)/g(x)\]</div>
<p>and by composition <span class="math notranslate nohighlight">\(f(g(x))\)</span>, each applied a finite number of times.</p>
<p>In <strong>FreeFEM</strong>, all elementary functions can thus be created.
The derivative of an elementary function is also an elementary function; however, the indefinite integral of an elementary function cannot always be expressed in terms of elementary functions.</p>
<p>See <a class="reference internal" href="../example/developers.html#exampleelementaryfunction"><span class="std std-ref">Elementary function example</span></a> for a complete example.</p>
</div>
<div class="section" id="random-functions">
<h3>Random functions<a class="headerlink" href="#random-functions" title="Permalink to this headline"> </a></h3>
<p><strong>FreeFEM</strong> includes the <a class="reference external" href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">Mersenne Twister</a> random number generator.
It is a very fast and accurate random number generator of period <span class="math notranslate nohighlight">\(2^{219937}-1\)</span>.</p>
<p>See <a class="reference internal" href="functions.html#referencerandint32"><span class="std std-ref">randint32()</span></a>, <a class="reference internal" href="functions.html#referencerandint31"><span class="std std-ref">randint31()</span></a>, <a class="reference internal" href="functions.html#referencerandreal1"><span class="std std-ref">randreal1()</span></a>, <a class="reference internal" href="functions.html#referencerandreal2"><span class="std std-ref">randreal2()</span></a>, <a class="reference internal" href="functions.html#referencerandreal3"><span class="std std-ref">randreal3()</span></a>, <a class="reference internal" href="functions.html#referencerandres53"><span class="std std-ref">randres53()</span></a>, <a class="reference internal" href="functions.html#referencerandinit"><span class="std std-ref">randinit(seed)</span></a>.</p>
<p>In addition, the <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ffrandom</span></code> plugin interface <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">random</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandom</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandomdev</span></code> functions of the Unix <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">libc</span></code> library.
The range is <span class="math notranslate nohighlight">\(0 -- 2^{31}-1\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandomdev</span></code> is not defined, a seed based on the current time is used.</p>
</div>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gsl</span></code> plugin equally allows usage of all random functions of the <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">gsllib</span></code>, see <a class="reference internal" href="externalLibraries.html#referenceffgslawk"><span class="std std-ref">gsl external library</span></a>.</p>
</div>
<div class="section" id="fe-functions">
<h3>FE-functions<a class="headerlink" href="#fe-functions" title="Permalink to this headline"> </a></h3>
<p>Finite element functions are also constructed like elementary functions by an arithmetic formula involving elementary functions.</p>
<p>The difference is that they are evaluated at declaration time and <strong>FreeFEM</strong> stores the array of its values at the places associated with he degree of freedom of the finite element type.
By opposition, elementary functions are evaluated only when needed.
Hence FE-functions are not defined only by their formula but also by the mesh and the finite element which enter in their definitions.</p>
<p>If the value of a FE-function is requested at a point which is not a degree of freedom, an interpolation is used, leading to an interpolation error, while by contrast, an elementary function can be evaluated at any point exactly.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span> <span class="c1">// ]-2, 2[^2</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">fh</span><span class="o">=</span><span class="n">f</span><span class="p">;</span> <span class="c1">//fh is the projection of f to Vh (real value)</span>
<span class="kt">func</span> <span class="n">zf</span> <span class="o">=</span> <span class="p">(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nf">exp</span><span class="p">(</span><span class="kr">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Vh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">zh</span> <span class="o">=</span> <span class="n">zf</span><span class="p">;</span> <span class="c1">//zh is the projection of zf to complex value Vh space</span>
</pre></div>
</td></tr></table></div>
<p>The construction of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span> <span class="o">=</span> <span class="n">f</span></code> is explained in <a class="reference internal" href="../documentation/finiteElement.html#finiteelement"><span class="std std-ref">Finite Element</span></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">plot</span></code> command only works for real or complex FE-functions, not for elementary functions.</p>
</div>
</div>
</div>
<div class="section" id="problem-design">
<span id="typeproblemdesign"></span><h2>Problem design<a class="headerlink" href="#problem-design" title="Permalink to this headline"> </a></h2>
<div class="section" id="problem">
<span id="typeproblem"></span><h3>problem<a class="headerlink" href="#problem" title="Permalink to this headline"> </a></h3>
<p>Problem type.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p><strong>FreeFEM</strong> needs the variational form in the problem definition.</p>
<p>In order to solve the problem, just call:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Laplacian</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Solver</p>
<p>A solver can be specified in the problem definition:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p>The default solver is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code> if any direct sparse solver is available.</p>
<p class="last">Solvers are listed in the <a class="reference internal" href="globalVariables.html#globalvariables"><span class="std std-ref">Global variables</span></a> section.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Stop test</p>
<p>A criterion <span class="math notranslate nohighlight">\(\varepsilon\)</span> can be defined for iterative methods, like CG for example:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span> <span class="kp">eps</span><span class="o">=</span><span class="mf">1.e-6</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p>If <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, the stop test is:</p>
<div class="math notranslate nohighlight">
\[||Ax-b|| &lt; \varepsilon\]</div>
<p>Else, the stop test is:</p>
<div class="last math notranslate nohighlight">
\[||Ax-b|| &lt; \frac{|\varepsilon|}{||Ax_0-b||}\]</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Reconstruction</p>
<p>The keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span></code> controls the reconstruction of the internal problem matrix.</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span></code> is set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">0</span></code>, the matrix is reconstructed et each problem calls (or after a mesh modification), else the previously constructed matrix is used.</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Preconditioning</p>
<p>A preconditioner can be specified in the problem definition:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">precon</span><span class="o">=</span><span class="kr">P</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p>The preconditioning function must have a prototype like:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">P</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">xx</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>“<em>Très grande valeur</em>”</p>
<p>The “<em>Très grand valeur</em>” <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span></code> (or <em>Terrible giant value</em>) used to implement the Dirichlet conditions can be modified in the problem definition:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=</span><span class="mf">1e30</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p class="last">Refere to <a class="reference internal" href="../documentation/finiteElement.html#problemdefinition"><span class="std std-ref">Problem definition</span></a> for a description of the Dirichlet condition implementation.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pivot tolerance</p>
<p>The tolerance of the pivot in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> factorization can be modified in the problem definition:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">tolpivot</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p>
<p>Two specific parameters for the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> can be modifed:</p>
<ul class="simple">
<li>Tolerance of the pivot sym</li>
<li>strategy</li>
</ul>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">tolpivotsym</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="kp">strategy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p class="last">Refer to the <a class="reference external" href="http://faculty.cse.tamu.edu/davis/research.html">UMFPACK website</a> for more informations.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">dimKrylov</span></code></p>
<p class="last">Dimension of the Krylov space</p>
</div>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">problem</span></code> is detailled in the <a class="reference internal" href="../tutorials/index.html#tutorials"><span class="std std-ref">tutorials</span></a>.</p>
</div>
<div class="section" id="solve">
<span id="typesolve"></span><h3>solve<a class="headerlink" href="#solve" title="Permalink to this headline"> </a></h3>
<p>Solve type.</p>
<p>Identical to <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a> but automatically solved.</p>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">solve</span></code> is detailled in the <a class="reference internal" href="../tutorials/index.html#tutorials"><span class="std std-ref">tutorials</span></a>.</p>
</div>
<div class="section" id="varf">
<span id="typevarf"></span><h3>varf<a class="headerlink" href="#varf" title="Permalink to this headline"> </a></h3>
<p>Variational form type.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">varf</span> <span class="n">vLaplacian</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p>Directly define a variational form.</p>
<p>This is the other way to define a problem in order to directly manage matrix and right hang side.</p>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> is detailed in the <a class="reference internal" href="../tutorials/index.html#tutorials"><span class="std std-ref">tutorial</span></a>.</p>
</div>
</div>
<div class="section" id="array">
<h2>Array<a class="headerlink" href="#array" title="Permalink to this headline"> </a></h2>
<p>An array stores multiple objects, and there are 2 kinds of arrays:</p>
<ul class="simple">
<li>the first is similar to vector, i.e.&nbsp;array with integer indices</li>
<li>the second is array with string indices</li>
</ul>
<p>In the first case, the size of the array must be known at execution time, and implementation is done with the <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">KN</span><span class="p">&lt;&gt;</span></code> class and all the vector operator of <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">KN</span><span class="p">&lt;&gt;</span></code> are implemented.</p>
<p>Arrays can be set like in Matlab or Scilab with the operator <code class="docutils literal highlight highlight-freefem"><span></span><span class="o">::</span></code>, the array generator of <code class="docutils literal highlight highlight-freefem"><span></span><span class="nl">a</span><span class="o">:</span><span class="n">c</span></code> is equivalent to <code class="docutils literal highlight highlight-freefem"><span></span><span class="nl">a</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="n">c</span></code>, and the array set by <code class="docutils literal highlight highlight-freefem"><span></span><span class="nl">a</span><span class="o">:</span><span class="nl">b</span><span class="o">:</span><span class="n">c</span></code> is set to size <span class="math notranslate nohighlight">\(\lfloor |(b-a)/c|+1 \rfloor\)</span> and the value <span class="math notranslate nohighlight">\(i\)</span> is set by <span class="math notranslate nohighlight">\(a + i (b-a)/c\)</span>.</p>
<p>There are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span> <span class="kt">complex</span></code> array with, in the third case, two operators (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">im</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">re</span></code>) to generate the real and imaginary real array from the complex array (without copy).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Quantiles are points taken at regular intervals from the cumulative distribution function of a random variable.
Here the array values are random.</p>
<p>This statistical function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span><span class="p">.</span><span class="kr">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">)</span></code> computes <span class="math notranslate nohighlight">\(v\)</span> from an array <span class="math notranslate nohighlight">\(a\)</span> of size <span class="math notranslate nohighlight">\(n\)</span> for a given number <span class="math notranslate nohighlight">\(q\in ]0,1[\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\#\{ i / a[i] &lt; v \} \sim q*n\]</div>
<p class="last">it is equivalent to <span class="math notranslate nohighlight">\(v = a[q*n]\)</span> when the array <span class="math notranslate nohighlight">\(a\)</span> is sorted.</p>
</div>
<p>For example, to declare, fill and display an array of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> of size <code class="docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span></code>:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Ai</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">Ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Ai</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The output of this script is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">5</span>
      <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>   <span class="m">3</span>   <span class="m">4</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../example/developers.html#examplearray"><span class="std std-ref">Array example</span></a> for a complete example.</p>
<div class="section" id="array-index">
<h3>Array index<a class="headerlink" href="#array-index" title="Permalink to this headline"> </a></h3>
<p>Array index can be int or string:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Ai</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span> <span class="n">As</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="array-size">
<h3>Array size<a class="headerlink" href="#array-size" title="Permalink to this headline"> </a></h3>
<p>The size of an array is obtained using the keyword <code class="docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span></code>:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ArraySize</span> <span class="o">=</span> <span class="n">Ai</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="array-sort">
<h3>Array sort<a class="headerlink" href="#array-sort" title="Permalink to this headline"> </a></h3>
<p>To sort an array:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Ai</span><span class="p">.</span><span class="nf">sort</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="double-array">
<h3>Double array<a class="headerlink" href="#double-array" title="Permalink to this headline"> </a></h3>
<p>A double array (matrix) can be defined using two indexes:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">Aii</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]];</span>
</pre></div>
</td></tr></table></div>
<p>The two sizes are obtained using the keywords <code class="docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="kr">m</span></code>:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ArraySize1</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">ArraySize2</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The minimum and maximum values of an array (simple or double) can be obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">ArrayMin</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">min</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">ArrayMax</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Th minimum and maximum position of an array can be obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">mini</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">imin</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">minj</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="n">jmin</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">maxi</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">imax</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">maxj</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="n">jmax</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>An array can be obtained from a finite element function using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">aU</span> <span class="o">=</span> <span class="n">U</span><span class="p">[];</span>
</pre></div>
</td></tr></table></div>
<p class="last">where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">U</span></code> is a finite element function.</p>
</div>
</div>
<div class="section" id="array-of-fe-functions">
<h3>Array of FE functions<a class="headerlink" href="#array-of-fe-functions" title="Permalink to this headline"> </a></h3>
<p>It is also possible to make an array of FE functions, with the same syntax, and we can treat them as vector valued function if we need them.</p>
<p>The syntax for space or vector finite function is</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">//size of the array.</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">wh</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//real scalar case</span>
<span class="n">Wh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">uh</span><span class="p">,</span><span class="n">vh</span><span class="p">](</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//real vectorial case</span>
<span class="n">Vh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">cwh</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//complex scalar case</span>
<span class="n">Wh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">cuh</span><span class="p">,</span> <span class="n">cvh</span><span class="p">](</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//complex vectorial case</span>
<span class="p">[</span><span class="n">cuh</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cvh</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">];</span> <span class="c1">//set interpolation of index 2</span>

<span class="c1">// Array of Array</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="kt">matrix</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">B</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="kp">A</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Example</p>
<p>In the following example, Poisson’s equation is solved for 3 different given functions <span class="math notranslate nohighlight">\(f=1,\, \sin(\pi x)\cos(\pi y),\, |x-1||y-1|\)</span>, whose solutions are stored in an array of FE function.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="nf">Poisson</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
      <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
      <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">v</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="p">;</span>

<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">uu</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">//an array of FE function</span>
<span class="c1">// Solve problem 1</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
<span class="c1">// Solve problem 2</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
<span class="c1">// Solve problem 3</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>

<span class="c1">// Plot</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">uu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p class="last">See <a class="reference internal" href="../example/developers.html#examplefearray"><span class="std std-ref">FE array example</span></a>.</p>
</div>
</div>
<div class="section" id="map-arrays">
<h3>Map arrays<a class="headerlink" href="#map-arrays" title="Permalink to this headline"> </a></h3>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span> <span class="n">map</span><span class="p">;</span> <span class="c1">//a dynamic array</span>

<span class="n">map</span><span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">map</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span> <span class="c1">//2 is automatically cast to the string &quot;2&quot;</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;map[</span><span class="se">\&quot;</span><span class="s">1</span><span class="se">\&quot;</span><span class="s">] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">map</span><span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;map[2] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">map</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>It is just a map of the standard template library so no operations on vector are allowed, except the selection of an item.</p>
</div>
</div>
<div class="section" id="matrix">
<span id="typematrix"></span><h2>matrix<a class="headerlink" href="#matrix" title="Permalink to this headline"> </a></h2>
<p>Defines a sparse matrix.</p>
<p>Matrices can be defined like vectors:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]];</span>
</pre></div>
</td></tr></table></div>
<p>or using a variational form type (see <a class="reference internal" href="../documentation/finiteElement.html#variationalformsparsematrixpde"><span class="std std-ref">Finite Element</span></a>):</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="n">Laplacian</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>or from block of matrices:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A1</span><span class="p">,</span> <span class="p">...,</span> <span class="n">An</span><span class="p">;</span>
<span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">[[</span><span class="kp">A1</span><span class="p">,</span> <span class="p">...],</span> <span class="p">...,</span> <span class="p">[...,</span> <span class="n">An</span><span class="p">]];</span>
</pre></div>
</td></tr></table></div>
<p>or using sparse matrix set:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kp">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">C</span><span class="p">];</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">I</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">J</span></code> are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">C</span></code> is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>. The matrix is defined as:</p>
<div class="math notranslate nohighlight">
\[A = \sum_k{C[k]M_{I[k], J[k]}}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{a, b} = \left(\delta_{ia}\delta_{jb}\right)_{ij}\)</span></p>
<p><cite>I</cite>, <cite>J</cite> and <cite>C</cite> can be retrieved using <cite>[I, J, C] = A</cite> (arrays are automatically resized).</p>
<p class="last">The size of the matrix is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span> <span class="o">=</span> <span class="n">I</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">m</span> <span class="o">=</span> <span class="n">J</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span></code>.</p>
</div>
<p>Matrices are designed using templates, so they can be real or complex:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">...</span>
<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">Ai</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Solver</p>
<p>See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
<p>The default solver is <a class="reference internal" href="globalVariables.html#globalvariablesgmres"><span class="std std-ref">GMRES</span></a>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>or</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">set</span><span class="p">(</span><span class="kp">A</span> <span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Factorize</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code>, the factorization is done for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>or</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">set</span><span class="p">(</span><span class="kp">A</span> <span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Stop test</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><em>Très grande valeur</em></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Preconditioning</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pivot tolerance</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">dimKrylov</span></code></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>datafilename</p>
<p class="last">Name of the file containing solver parameters, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code></p>
<p class="last">Vector of integer parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code></p>
<p class="last">Vector of real parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code></p>
<p class="last">String parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">To modify the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span></code>, the stop test,… after the matrix construction, use the <a class="reference internal" href="functions.html#functionset"><span class="std std-ref">set keyword</span></a>.</p>
</div>
<div class="section" id="matrix-size">
<h3>Matrix size<a class="headerlink" href="#matrix-size" title="Permalink to this headline"> </a></h3>
<p>The size of a matrix is obtain using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">NRows</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">NColumns</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="matrix-resize">
<h3>Matrix resize<a class="headerlink" href="#matrix-resize" title="Permalink to this headline"> </a></h3>
<p>To resize a matrix, use:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kp">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kr">m</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When resizing, all new terms are set to zero.</p>
</div>
</div>
<div class="section" id="matrix-diagonal">
<h3>Matrix diagonal<a class="headerlink" href="#matrix-diagonal" title="Permalink to this headline"> </a></h3>
<p>The diagonal of the matrix is obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Aii</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">diag</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="matrix-renumbering">
<h3>Matrix renumbering<a class="headerlink" href="#matrix-renumbering" title="Permalink to this headline"> </a></h3>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">I</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">J</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">;</span>
<span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">);</span>
<span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">(</span><span class="n">I</span><span class="o">^-</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="o">^-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="complex-matrix">
<h3>Complex matrix<a class="headerlink" href="#complex-matrix" title="Permalink to this headline"> </a></h3>
<p>Use <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">im</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">re</span></code> to get the imaginary and real part of a complex matrix, respectively:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="p">...</span>
<span class="kt">matrix</span> <span class="n">R</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="kr">re</span><span class="p">;</span>
<span class="kt">matrix</span> <span class="n">I</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="kr">im</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="dot-product-outer-product">
<h3>Dot product / Outer product<a class="headerlink" href="#dot-product-outer-product" title="Permalink to this headline"> </a></h3>
<p>The dot product of two matrices is realized using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="nf">d</span> <span class="o">=</span> <span class="kp">A</span><span class="o">&#39;</span> <span class="o">*</span> <span class="kp">B</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The outer product of two matrices is realized using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="n">C</span> <span class="o">=</span> <span class="kp">A</span> <span class="o">*</span> <span class="kp">B</span><span class="o">&#39;</span>
</pre></div>
</td></tr></table></div>
<p>See <a class="reference internal" href="../example/developers.html#examplematrixoperations"><span class="std std-ref">Matrix operations example</span></a> for a complete example.</p>
</div>
<div class="section" id="matrix-inversion">
<h3>Matrix inversion<a class="headerlink" href="#matrix-inversion" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="../example/developers.html#examplematrixinversion"><span class="std std-ref">Matrix inversion example</span></a>.</p>
</div>
</div>
</div>


		</div>
		
		<div id="toc">
	<div>
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Types</a><ul>
<li><a class="reference internal" href="#standard-types">Standard types</a><ul>
<li><a class="reference internal" href="#int">int</a></li>
<li><a class="reference internal" href="#bool">bool</a></li>
<li><a class="reference internal" href="#real">real</a></li>
<li><a class="reference internal" href="#complex">complex</a></li>
<li><a class="reference internal" href="#string">string</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mesh-design">Mesh design</a><ul>
<li><a class="reference internal" href="#border">border</a></li>
<li><a class="reference internal" href="#mesh">mesh</a></li>
<li><a class="reference internal" href="#mesh3">mesh3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finite-element-space-design">Finite element space design</a><ul>
<li><a class="reference internal" href="#fespace">fespace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#macro-design">Macro design</a><ul>
<li><a class="reference internal" href="#macro">macro</a></li>
<li><a class="reference internal" href="#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li><a class="reference internal" href="#ifmacro">IFMACRO</a></li>
<li><a class="reference internal" href="#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions-design">Functions design</a><ul>
<li><a class="reference internal" href="#func">func</a></li>
<li><a class="reference internal" href="#elementary-functions">Elementary functions</a></li>
<li><a class="reference internal" href="#random-functions">Random functions</a></li>
<li><a class="reference internal" href="#fe-functions">FE-functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#problem-design">Problem design</a><ul>
<li><a class="reference internal" href="#problem">problem</a></li>
<li><a class="reference internal" href="#solve">solve</a></li>
<li><a class="reference internal" href="#varf">varf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#array">Array</a><ul>
<li><a class="reference internal" href="#array-index">Array index</a></li>
<li><a class="reference internal" href="#array-size">Array size</a></li>
<li><a class="reference internal" href="#array-sort">Array sort</a></li>
<li><a class="reference internal" href="#double-array">Double array</a></li>
<li><a class="reference internal" href="#array-of-fe-functions">Array of FE functions</a></li>
<li><a class="reference internal" href="#map-arrays">Map arrays</a></li>
</ul>
</li>
<li><a class="reference internal" href="#matrix">matrix</a><ul>
<li><a class="reference internal" href="#matrix-size">Matrix size</a></li>
<li><a class="reference internal" href="#matrix-resize">Matrix resize</a></li>
<li><a class="reference internal" href="#matrix-diagonal">Matrix diagonal</a></li>
<li><a class="reference internal" href="#matrix-renumbering">Matrix renumbering</a></li>
<li><a class="reference internal" href="#complex-matrix">Complex matrix</a></li>
<li><a class="reference internal" href="#dot-product-outer-product">Dot product / Outer product</a></li>
<li><a class="reference internal" href="#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
</ul>

	</div>
</div>
		<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation/" target="_blank">BibTeX</a>
	</div>
</footer>
		

		<script async src="../_static/js/common.js"></script>
	</body>
</html>
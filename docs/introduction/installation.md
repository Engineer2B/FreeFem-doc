# Installation guide

## Compilation on OSX (>=10.13)

Remark: Blocks of code are shell commands in terminal. 

1) Install Xcode, Xcode command line tools and Xcode Auxiliaire Tools from [Apple website](https://developer.apple.com/download/more/)

2) Install  gcc from [http://hpc.sourceforge.net](http://hpc.sourceforge.net/)

```
curl -O http://prdownloads.sourceforge.net/hpc/gfortran-7.1-bin.tar.gz?download
sudo tar zxvf gfortran-7.1-bin.tar.gz -C /
```

3) Install autoconf and automake from [macport](http://www.macports.org) or with [Homebrew](https://brew.sh)

```
sudo port install  autoconf
sudo port install  automatke
```

4) install mactex  from  [ctan](http://mirrors.ctan.org/systems/mac/mactex/MacTeX.pkg) 

5) install [openmpi](https://www.open-mpi.org/software/) source code

```
./configure CC=/usr/local/bin/gcc CXX=/usr/local/bin/g++ F77=/usr/local/bin/gfortran FC=/usr/local/bin/gfortran
make 
sudo make install
```

6) Install [gsl](https://www.gnu.org/software/gsl) 

```
curl -O https://fr.mirror.babylon.network/gnu/gsl/gsl-2.4.tar.gz
tar zxvf gsl-2.4.tar.gz
cd gsl-2.4
./configure CC=/usr/local/bin/gcc
make
sudo make install 
```

7) Install [git](https://git-scm.com/download/mac)
    
8) Download FreeFem++ source from the repository

```
git clone https://github.com/FreeFem/FreeFem-sources.git
```

9) Compile FreeFem++. Don't Forget to update the MacOSX sdk version with your own in the command below:

```
cd ff++
./configure '-with-suffix=macos-10.13' '-without-fltk' '--enable-download' '--enable-optim' 'MPIRUN=/usr/local/bin/mpirun' '--enable-m64' '--without-x' 'CC=clang -isysroot /Applications/Xcode.app//Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk' 'CFLAGS=-mmacosx-version-min=10.13' 'CXXFLAGS=-mmacosx-version-min=10.13 -std=c++11' 'CXX=clang++ -isysroot /Applications/Xcode.app//Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk' 'F77=/usr/local/bin/gfortran' 'FC=/usr/local/bin/gfortran' 'MPICXX=/usr/local/bin/mpic++' 'MPICC=/usr/local/bin/mpicc' 'MPIFC=/usr/local/bin/mpif90' 'MPIF77=/usr/local/bin/mpif90' '--enable-maintainer-mode'
make
sudo make install
```

## Compilation on Ubuntu

1) Install the following dependencies
```bash
sudo apt-get update && sudo apt-get upgrade
sudo apt-get install cpp freeglut3-dev g++ gcc gfortran \
	ghostscript m4 make patch pkg-config wget python \
	libopenblas-dev liblapack-dev libhdf5-dev libgsl2-dev \
	libscotch-dev libfftw3-dev libarpack2-dev libsuitesparse-dev \
	libmumps-seq-dev libnlopt-dev coinor-libipopt-dev libgmm++-dev libtet1.5-dev \
	gnuplot-qt autoconf automake autotools-dev bison flex gdb valgrind git cmake

# mpich is required for the FreeFem parallel computing version
sudo apt-get install mpich
```

!!!warning
	In the latest distribution of Ubuntu, libgsl2-dev does not exists anymore

2) Download FreeFem++ source from the repository

```bash
git clone https://github.com/FreeFem/FreeFem-sources.git
```

3) Autoconf

```bash
cd FreeFem-sources
autoreconf -i 
```

!!!info
	if your autoreconf version is too old, do `tar zxvf AutoGeneratedFile.tar.gz`

4) Configure

```bash
./configure --enable-download --enable-optim --disable-pastix
```

!!!info
	To see all the options, type `./configure --help`

5) Download the packages

```bash
./download/getall -a
```

!!!info
	All the third party packages have their own licence

6) Download and compile petsc & slepc

```bash
cd download/ff-petsc
make petsc-slepc SUDO=sudo
cd -
```

!!! warning
	Pastix seems to fail during the PETSc compilation. You can remove `--download-pastix` directly in the `Makefile` if a compilation error occurs.

7) Reconfigure with petsc and slepc

```bash
./reconfigure
```

8) Build

```bash
make
```

!!!note
	If your computer have many threads, you can run `make` in parallel using `make -j16` for 16 threads for example.

!!!info 
	Optionnally, check the compilation with `make check`

9) Install

```bash
sudo make install
```

## Compilation on Arch

!!! warning
	As Arch is in rolling release, the following informations can be quickly exceeded !

1) Install the following dependencies:

```bash
pacman -Syu
pacman -S git openmpi gcc-fortran wget python
	freeglut ghostscript m4 make patch gmm
	blas lapack hdf5 gsl fftw arpack suitesparse
	gnuplot autoconf automake bison flex gdb
	valgrind cmake texlive-most

```

2) Download FreeFem++ source from the repository

```bash
git clone https://github.com/FreeFem/FreeFem-sources.git
```

3) Autoconf

```bash
cd FreeFem-sources
autoreconf -i 
```

4) Configure

```bash
./configure --enable-download --enable-optim --disable-pastix
```

!!!info
	To see all the options, type `./configure --help`

5) Download the packages

```bash
./download/getall -a
```

!!!info
	All the third party packages have their own licence

6) Download and compile petsc & slepc

```bash
cd download/ff-petsc
make petsc-slepc SUDO=sudo
cd -
```
7) Reconfigure with petsc and slepc

```bash
./reconfigure
```

8) Build

```bash
make
```

!!!note
	If your computer have many threads, you can run `make` in parallel using `make -j16` for 16 threads for example.

!!!info 
	Optionnally, check the compilation with `make check`

9) Install

```bash
sudo make install
```

## Compilation on Windows
TODO (Good luck!)



